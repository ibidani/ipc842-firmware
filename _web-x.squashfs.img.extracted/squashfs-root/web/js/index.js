var base_pwd="",mbbw=0,mbbh=0,Ptz_Menu_Height=0,DeviceIP="",authorityList=[],ptzCap=null,hasPtz=!0,isIntellent=!1,play_state=0,play_pre=0,RE_OPEN_REAL_SUCCESS=!1,SHOW_TIPS=!1,bool_PTZfunction=!1,IS_CGI_SEND=!1,alarm_timer=0,support_scenes=["Normal"],support_sceneTypes=[],isMoving=!0,timer_focus=0,IPCIntellentShow=!1,gsld1={},gsld2={},gsld3={},gsld4={},gwid=0,gcid=-1,gxh=0,gxz=0,gxs=0,gxj=0,gytcd=0,gfz=0,rpcPtz=new PtzCtrl,rpcIDIT=new IDevIntelliTracker,jsonAlarmOut=[],jsonVideoIn=null,ALARM_IN_NUMBER=
-1,ALARM_OUT_NUMBER=-1,alarmOutState="",jsonAlarmOut=null,alarmOutInterval=0,g_loginType="Direct",g_wirelessCap=!1,alarm_Wireless_num=0,Sys={},ua=navigator.userAgent.toLowerCase(),s;(s=ua.match(/msie ([\d.]+)/))?Sys.ie=s[1]:(s=ua.match(/firefox\/([\d.]+)/))?Sys.firefox=s[1]:(s=ua.match(/chrome\/([\d.]+)/))?Sys.chrome=s[1]:(s=ua.match(/opera.([\d.]+)/))?Sys.opera=s[1]:(s=ua.match(/version\/([\d.]+).*safari/))&&(Sys.safari=s[1]);var haveqt=!1;
if(navigator.plugins)for(var i=0;i<navigator.plugins.length;i++)navigator.plugins[i].name.indexOf("QuickTime")>=0&&(haveqt=!0);
var webCaps=webCaps||getWebCapsConfig(),isAnonymous=webCaps.Anonymous,currenDeviceType=webCaps.deviceType,currentSdDeviceType=webCaps.DeviceSubClass||"",currenVendor=webCaps.vendor,TALK_CODING_TYPE=["DEFAULT","PCM","G.711A","AMR","G.711Mu","G.726","G723_53","G723_63","AAC"],gst_sel=-1,HashCookie=new Hash.Cookie("DhWebCookie",{duration:30}),settings={username:"",pswd:"",talktype:"1",logintype:"0"},isFLIR=!1,g_LoginId=0,dialogQT,g_audioInputNum=null,g_audioOutputNum=null,g_aliveInterval,hasSDCard,g_isABFFunction=
!1,g_isFocusRegion=!1,g_isHasFocus=!1,g_zoomSlider,g_focusSlider,g_zoomStep=0,g_focusStep=0,g_getTiming="",g_overTiming="",b_stepSave=!0,b_autoFocus=!1,b_stepReturn=!0,zoomFX="",focusFX="",zoomSpeed=0,zoomRate=0.032,focusRate=0.02,zoomFocusTime="",b_Continue=!1,g_protocol_boolean=!1,b_sendContinue=!1,g_stepConnectCount=0,g_focusStatuss=0,focusMousedown=!1,mouseCtrPTZArr=[[0,0,0],[0,0,0],[0,0,0]],mouseCtePTZNumber=0,isLoadSetContent=!1,jsonAlarmConfig=null,keepActiveTime=!1,g_audioMangerCap={audioMangerCap:!1,
VolumeDetect:!1,AnomalyDetect:!1,MutationDetect:!1},SVAC={isSVAC:!1,isPwd:!1,pwd:"",isSVC:0},g_isHasfisheye=!1,g_isFisheyeOpen=!1,devVideoDetectCaps={},g_ZoomMotorSteps=0,g_FocusMotorSteps=0,g_Focusing=!1,g_isZoom=!1,g_clickType=!1,isAutoFocus=!1,g_dragStep,g_clearFocus,g_focusState="Normal",g_lastFocusStep=-1,g_beginFocus=!1,autoFocusConfig={videoInput:null,getDevVideoInput:function(){autoFocusConfig.videoInput.getCapsEx(function(a){if(JSON.decode(a).result)a=JSON.decode(a).params.caps,g_isABFFunction=
a.ABFFunction.Support,(g_isFocusRegion=a.VideoInFocus&&a.VideoInFocus.SupportFocusRegion)&&$("reginFocus").setStyle("display","")},0,"ALL",!1);autoFocusConfig.videoInput.getCaps(function(a){if(JSON.decode(a).result)((g_isHasFocus=JSON.decode(a).params.caps.ElectricFocus)||g_isABFFunction)&&checkAuthority("VideoInputConfig")?($("video_focus_adjust").setStyle("display",""),autoFocusConfig.getObjectID()):$("video_focus_adjust").setStyle("display","none");if(g_isABFFunction)$("t_zoomFocus").set("text",
tl("W_focus")),$("video_focus_adjust").set("title",tl("W_focus")),$("prev_ABFTitle").setStyle("display","none"),$("prev_ABFTMain").setStyle("display","none"),$("prev_ABFFoot").setStyle("display","none"),$("t_focus").set("text",tl("w_Step")),$("t_step2").style.display="none",$("t_near").style.display="none",$("t_far").style.display="none"},0,!1)},getObjectID:function(){autoFocusConfig.videoInput.getCaps(function(a){JSON.decode(a).result&&autoFocusConfig.setTimeAuto()},0,!1)},setRestoryAll:function(){autoFocusConfig.disabledButton(!0);
autoFocusConfig.clearTimeAuto();g_overTiming=autoFocusConfig.stepReturn.delay(1E4);autoFocusConfig.videoInput.adjustFocus(function(a){if(JSON.decode(a).result)$("g_zoomStep").value=20,$("g_focusStep").value=20,autoFocusConfig.clearTimeAuto(),autoFocusConfig.setTimeAuto()},0,-1,-1,!0)},reginFocus:function(){if(!this.hasClass("ui-button-disabled"))if(this.hasClass("ui-button-current"))$("ocx")&&$("ocx").SubVideoWndCtrl(16,0)&&this.removeClass("ui-button-current");else{if($("b_range").hasClass("main-top-icon-big-current")&&
$("ocx")&&$("ocx").SubVideoWndCtrl(5,0)&&($("b_range").removeClass("main-top-icon-big-current"),$("b_Stream1").hasClass("ui-button-main-current")&&(IPCIntellentShow||isIntellent)))$("video_IVS_con").setStyle("display",""),$$("#video_ivs_wrap .ui-video-wrap-item")[0].hasClass("ui-video-wrap-current")&&$("ocx")&&$("ocx").SetIVSEnable(!0);$("ocx")&&$("ocx").SubVideoWndCtrl(16,1)&&this.addClass("ui-button-current")}},getReginFocus:function(a){autoFocusConfig.disabledButton(!0);autoFocusConfig.videoInput.focusRegion(function(){g_isZoom=
g_Focusing=!0},"InROIRegion",a,0)},getautoFocus:function(){isAutoFocus=!0;autoFocusConfig.disabledButton(!0);b_stepReturn=!0;autoFocusConfig.clearTimeAuto();autoFocusConfig.videoInput.autoFocus(function(a){JSON.decode(a).result&&(autoFocusConfig.clearTimeAuto(),b_stepReturn=!1,g_isZoom=g_Focusing=!0)},0,!0)},getFocusStatus:function(){g_getTiming&&$clear(g_getTiming);b_stepReturn=!0;autoFocusConfig.clearTimeAuto();g_overTiming=autoFocusConfig.stepReturn.delay(1E4);autoFocusConfig.videoInput.getFocusStatus(function(a){if(JSON.decode(a).result){autoFocusConfig.clearTimeAuto();
b_stepReturn=!1;a=JSON.decode(a).params.status;if(!g_ZoomMotorSteps||!g_FocusMotorSteps)g_ZoomMotorSteps=a.ZoomMotorSteps||2E3,g_FocusMotorSteps=a.FocusMotorSteps||2E3,g_zoomSlider.steps=g_zoomSlider.range=g_zoomSlider.max=g_ZoomMotorSteps,g_focusSlider.steps=g_focusSlider.range=g_focusSlider.max=g_FocusMotorSteps;g_zoomStep=a.Zoom*g_ZoomMotorSteps;g_focusStep=a.Focus*g_FocusMotorSteps;g_clickType="longClick";autoFocusConfig.setZoomFocus(g_zoomStep,g_focusStep);a.Status=="Autofocus"?autoFocusConfig.disabledButton(!0):
autoFocusConfig.disabledButton(!1);a.Status=="Normal"&&b_autoFocus?(g_getTiming&&$clear(g_getTiming),b_autoFocus=!1,$("autoFocus").className="ui-button-special",focusMousedown=!1):autoFocusConfig.setTimeAuto()}else JSON.decode(a).error.code==403&&(autoFocusConfig.clearTimeAuto(),autoFocusConfig.disabledButton(!0),focusMousedown=!1)},0,!0)},stepReturn:function(){g_stepConnectCount++;g_getTiming&&$clear(g_getTiming);!b_stepReturn||g_stepConnectCount>1?(autoFocusConfig.disabledButton(!1),g_stepConnectCount=
0):(autoFocusConfig.disabledButton(!1),autoFocusConfig.getFocusStatus())},clearTimeAuto:function(){g_overTiming&&$clear(g_overTiming)},setZoomFocus:function(a,b){b_stepSave=!1;g_clickType=="longClick"&&g_zoomSlider.set(a);b_stepSave=!1;g_focusSlider.set(b);b_stepSave=!0},saveZoomFocus:function(){b_stepReturn=!0;autoFocusConfig.disabledButton(!0);g_clickType=!1;var a=(g_zoomStep-0)/g_ZoomMotorSteps,b=(g_focusStep-0)/g_FocusMotorSteps;autoFocusConfig.clearTimeAuto();g_overTiming=autoFocusConfig.stepReturn.delay(1E4);
g_Focusing=!0;autoFocusConfig.videoInput.adjustFocus(function(a){if(JSON.decode(a).result){autoFocusConfig.clearTimeAuto();b_stepReturn=!1;g_focusState="Autofocus";var b=window.setInterval(function(){autoFocusConfig.videoInput.getFocusStatus(function(a){JSON.decode(a).result?JSON.decode(a).params.status.Status=="Normal"&&(window.clearInterval(b),autoFocusConfig.disabledButton(!1),g_Focusing=!1,g_focusState="Normal",g_beginFocus=!1):clearInterval(b)},0,!0)},500)}},0,b,a,!0)},setTimeAuto:function(){g_getTiming&&
$clear(g_getTiming);$("estopAll").getStyle("display")=="none"&&autoFocusConfig.disabledButton(!0);g_getTiming=function(){b_autoFocus=!0;autoFocusConfig.getFocusStatus()}.delay(1E3)},goZoomValue:function(a){var b=$("g_zoomStep").value-0;g_zoomStep==g_ZoomMotorSteps&&a>0||g_zoomStep==0&&a<0||(g_zoomStep=g_zoomStep-0+b*a-0,g_zoomStep>0&&g_zoomStep<g_ZoomMotorSteps?g_zoomSlider.set(g_zoomStep):g_zoomStep>=g_ZoomMotorSteps?(g_zoomStep=g_ZoomMotorSteps,g_zoomSlider.set(g_ZoomMotorSteps)):(g_zoomStep=0,
g_zoomSlider.set(0)))},goFocusValue:function(a){var b=$("g_focusStep").value-0;g_focusStep==g_FocusMotorSteps&&a>0||g_focusStep==0&&a<0||(g_focusStep=g_focusStep-0+b*a-0,g_focusStep>0&&g_focusStep<g_FocusMotorSteps?g_focusSlider.set(g_focusStep):g_focusStep>=g_FocusMotorSteps?(g_focusStep=g_FocusMotorSteps,g_focusSlider.set(g_FocusMotorSteps)):(g_focusStep=0,g_focusSlider.set(0)))},goValue:function(a,b){b==0?(autoFocusConfig.goZoomValue(a),g_isZoom=!0):(autoFocusConfig.goFocusValue(a),g_isZoom=!1);
b_Continue=!1},zoomEnd:function(a,b){b_Continue=focusMousedown=!0;zoomFX&&zoomFX.cancel();focusFX&&focusFX.cancel();b_sendContinue?(autoFocusConfig.disabledButton(!0),autoFocusConfig.adjustContinue(b,a,!0),b_sendContinue=!1,g_Focusing||autoFocusConfig.disabledButton(!1)):focusMousedown=!1},adjustContinue:function(a,b,c){b_stepReturn=!0;if(a==0){var d=-1;if(b==1)var e=zoomRate;else b==-1&&(e=-zoomRate);c&&(e=0)}else a==1&&(e=-1,b==1?d=focusRate:b==-1&&(d=-focusRate),c&&(d=0));autoFocusConfig.videoInput.adjustFocusContinuously(function(a){JSON.decode(a).result&&
(b_stepReturn=!1)},0,d,e,!0)},zoomContinue:function(a,b){b==0&&(isAutoFocus=!0);isAutoFocus&&b==1&&autoFocusConfig.videoInput.stopAutoFocus(function(){},0,!1);focusFX=zoomFX=null;b_sendContinue=b_Continue=!1;$("zoomS");$("focusS");parseInt($("zoomS").style.left);parseInt($("focusS").style.left);zoomFocusTime&&window.clearTimeout(zoomFocusTime);zoomFocusTime=window.setTimeout(function(){if(b_Continue)autoFocusConfig.goValue(a,b);else{if(b==0){if(g_zoomStep==0&&a<0||g_zoomStep==g_ZoomMotorSteps&&a>
0)return}else if(g_focusStep==0&&a<0||g_focusStep==g_FocusMotorSteps&&a>0)return;g_clickType="longClick";g_Focusing=!0;autoFocusConfig.adjustContinue(b,a);b_sendContinue=!0}},200)},disabledButton:function(a){try{window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()}catch(b){}a?($("autoFocus").removeEvents(),$("restoryAll").removeEvents(),$("restartAll").removeEvents(),$("zoomLess").removeEvents(),$("zoomMore").removeEvents(),isAutoFocus||($("focusLess").removeEvents(),
$("focusMore").removeEvents()),$("zoomL").disabled="disabled",$("zoomS").disabled="disabled",$("focusL").disabled="disabled",$("focusS").disabled="disabled",$("reginFocus").disabled="disabled",$("reginFocus").hasClass("ui-button-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(16,0)&&$("reginFocus").removeClass("ui-button-current"),$("reginFocus").addClass("ui-button-disabled"),$("autoFocus").className="ui-button-special ui-button-disabled",$("restoryAll").className="ui-button ui-button-disabled",$("restartAll").className=
"ui-button ui-button-disabled",$("zoomEstop").setStyle("display","block"),$("focusEstop").setStyle("display","block")):($("estopAll").setStyle("display","none"),$("zoomL").disabled=!1,$("zoomS").disabled=!1,$("focusL").disabled=!1,$("focusS").disabled=!1,$("reginFocus").disabled=!1,$("autoFocus").className="ui-button-special",$("restoryAll").className="ui-button",$("restartAll").className="ui-button",$("reginFocus").className="ui-button",$("zoomEstop").setStyle("display","none"),$("focusEstop").setStyle("display",
"none"),$("zoomLess").removeEvents(),$("zoomMore").removeEvents(),isAutoFocus||($("focusLess").removeEvents(),$("focusMore").removeEvents()),$("autoFocus").removeEvents(),$("restoryAll").removeEvents(),$("restartAll").removeEvents(),$("autoFocus").addEvent("click",autoFocusConfig.getautoFocus),$("restoryAll").addEvent("click",autoFocusConfig.setRestoryAll),$("restartAll").addEvent("click",autoFocusConfig.setTimeAuto),$("zoomMore").addEvents({mousedown:function(a){preventM(a);autoFocusConfig.zoomContinue(1,
0)},mouseup:function(a){preventM(a);autoFocusConfig.zoomEnd(1,0)},mouseout:function(a){preventM(a);autoFocusConfig.zoomEnd(1,0)}}),$("zoomLess").addEvents({mousedown:function(a){preventM(a);autoFocusConfig.zoomContinue(-1,0)},mouseup:function(a){preventM(a);autoFocusConfig.zoomEnd(-1,0)},mouseout:function(a){preventM(a);autoFocusConfig.zoomEnd(-1,0)}}),isAutoFocus?isAutoFocus=!1:($("focusMore").addEvents({mousedown:function(a){preventM(a);autoFocusConfig.zoomContinue(1,1)},mouseup:function(a){preventM(a);
autoFocusConfig.zoomEnd(1,1)},mouseout:function(a){preventM(a);autoFocusConfig.zoomEnd(1,1)}}),$("focusLess").addEvents({mousedown:function(a){preventM(a);autoFocusConfig.zoomContinue(-1,1)},mouseup:function(a){preventM(a);autoFocusConfig.zoomEnd(-1,1)},mouseout:function(a){preventM(a);autoFocusConfig.zoomEnd(-1,1)}})))}};
window.addEvent("domready",function(){function a(){resize();RE_OPEN_REAL_SUCCESS=!1;if(!SHOW_TIPS&&IS_CGI_SEND){var a=(new RPCCall).getRequest("getEventnum",null);sendRequest(a,function(){});SHOW_TIPS=!0}onClearOCXFunction();resetAFEnable();$("b_record").hasClass("main-top-icon-vedio-current")?$("b_voice").hasClass("main-top-icon-voice-current")&&($("ocx")&&$("ocx").SubVideoWndCtrl(1,0),$("b_voice").removeClass("main-top-icon-voice-current")):$("ocx")&&$("ocx").DisConnectRealVideo(0);play_pre=play_state;
$("b_focus").hasClass("main-top-icon-afocus-current")&&setfocus();if($("set_page")){if(filename=$$("#set a.set-item-current").getProperty("data-filename"),filename[0])Site.currentPage.is={},Site.currentPage.is[filename]=!0,Page[filename].render()}else loadHtmlFile("../set.htm",function(a){$("mb0").innerHTML=a;PageSet.init()},$empty,"2.210"),resize.delay(1E3);$clear(alarmOutInterval)}function b(){document.title=tl("w_Alarm");if(!Site.currentPage.isAlarm){$("ocx")&&$("ocx").SetModuleMode(0);c.call($("b_alarm"));
isEnable("is_8M_Flash")||(ALARM_IN_NUMBER=(new ChannelNumInfo).getAlarmIN());if(ALARM_IN_NUMBER==0)$("showAlarmType_5").style.display="none";if(!g_audioMangerCap.audioMangerCap||g_audioInputNum==0)$("showAlarmType_7").style.display="none";if(!IPCIntellentShow||support_scenes.contains("Traffic"))$("showAlarmType_8").style.display="none";g_audioMangerCap.VolumeDetect&&alarmEvent[7].include("AudioAnomaly");g_audioMangerCap.VolumeDetect&&alarmEvent[7].include("AudioMutation");onClearOCXFunction();resetAFEnable();
$("b_record").hasClass("main-top-icon-vedio-current")?$("b_voice").hasClass("main-top-icon-voice-current")&&($("ocx")&&$("ocx").SubVideoWndCtrl(1,0),$("b_voice").removeClass("main-top-icon-voice-current")):$("ocx")&&$("ocx").DisConnectRealVideo(0);PlayBack&&PlayBack.stop();$("mb").setStyles({top:"-10000px"});$("video1").setStyles({top:0,left:0});$("mb0").style.display="none";$("mb2").style.display="";SHOW_TIPS=!1;if($("alarm_frame").src==""||location.href.contains($("alarm_frame").src))IS_CGI_SEND=
!0,alarmCGI.open(),alarm_timer=setInterval("showAlarmTips()",1E3);$("b_focus").hasClass("main-top-icon-afocus-current")&&setfocus();resize()}}function c(){Site.currentPage.isPlayBack&&PlayBack&&PlayBack.stop();WideView.support&&(Site.currentPage.isPreview?WideView.navChangeLeft():WideView.navChangeIn());var a=this.getParent().getParent().id=="nav"?$$("#nav a.main-nav-item-current").getProperty("data-pagename"):$$("#nav1 a.main-nav-item1-current").getProperty("data-pagename");$$("#nav a.main-nav-item-current").fireEvent("leave");
$$("#nav1 a.main-nav-item1-current").fireEvent("leave");$$("#nav a").removeClass("main-nav-item-current");$$("#nav1 a").removeClass("main-nav-item1-current");this.getParent().getParent().id=="nav"?this.addClass("main-nav-item-current"):this.addClass("main-nav-item1-current");var b=this.get("data-pagename");Site.currentPage={};Site.currentPage.is={};b&&(Site.currentPage["is"+b]=!0,b=="Setup"&&PageSet.render&&PageSet.render(),a=="Setup"&&PageSet.leave&&PageSet.leave(),a=="PlayBack"&&PlayBack&&PlayBack.leave&&
PlayBack.leave());$$("#video_ivs_wrap .ui-video-wrap-item")[0].hasClass("ui-video-wrap-current")&&!Site.currentPage.isPreview&&!Site.currentPage.isPTZ&&$("ocx")&&$("ocx").SetIVSEnable(!1);Site.currentPage.isPreview||ManualEv.statusFlag&&ManualEv.varSetStatusFlag(!1)}$("b_preview").addEvent("click",function(a){document.title=tl("w_Preview");if(!Site.currentPage.isPreview){c.call(this);$("mb").setStyles({top:"0px"});$("video1").setStyles({top:"-10000px",left:"0px"});$("mb0").style.display="none";$("mb2").style.display=
"none";if(!SHOW_TIPS&&IS_CGI_SEND){var b=(new RPCCall).getRequest("getEventnum",null);sendRequest(b,function(){});SHOW_TIPS=!0}g_audioInputNum==2&&audioInputPrev();checkAuthority("Alarm")&&(clearInterval(alarmOutInterval),(new ConfigManager).getConfig("AlarmOut",function(a){showAlarmChEx(a);var b=new Alarm;b.getOutState(getAlarmOutState);alarmOutInterval=setInterval(function(){b.getOutState(getAlarmOutState)},5E3)}));currenDeviceType.contains("SD")&&checkAuthority("MPTZ")&&hasPtz&&(a?$("video_ptz").hasClass("ui-video-icon-current")&&
($("ptz_control").setStyle("display",""),limitPtzCtrl()):(limitPtzCtrl(),$("ptz_control").setStyle("display","")));isIntellent&&rpcIDIT.start(function(){});$("video_image_adjust").hasClass("ui-video-icon-image-current")&&$("image_adjust").setStyle("display","");$("video_focus_adjust").hasClass("ui-video-icon-adjust-current")?$("focus_adjust").setStyle("display",""):$("focus_adjust").setStyle("display","none");$("videobar").setStyle("display","block");$$(".main-top").setStyle("display","");setIconVisible(!0);
$("playback_left_bar").setStyle("display","none");$("playback_bottom_bar").setStyle("display","none");isFLIR||$("video_image_adjust").setStyle("display","inline-block");$("ocx")&&$("ocx").SetModuleMode(0);openVideo();FishEye.init();resize();resize.delay(0);(g_isHasFocus||g_isABFFunction)&&checkAuthority("VideoInputConfig")&&autoFocusConfig.setTimeAuto();$("b_Stream1").hasClass("ui-button-main-current")&&SVAC.isSVAC&&SVAC.isSVC?$("video_svc_con").setStyle("display","block"):$("video_svc_con").setStyle("display",
"none")}});$("b_ptzctrl").addEvent("click",function(){document.title=tl("w_ptz");if(!Site.currentPage.isPTZ){c.call(this);$("ocx")&&$("ocx").SetModuleMode(0);openVideo();$("video1").setStyles({top:"-10000px",left:"0px"});$("mb").setStyles({top:"0px"});$("mb0").style.display="none";$("mb2").style.display="none";$("yt5").className="ui-ptz-icon-center";limitPtzCtrl();changePtzSetup($("ytszSelect").value);setIconVisible(!1);if(g_isHasfisheye)$("video_fisheye").style.display="none",$("fish_eye").style.display=
"none";$("ptz_help").style.display="";$("playback_help").style.display="none";$("playback_snap").style.display="none";$("playback_snap").getPrevious().addClass("fn-hide");$("playback_zoom").style.display="none";$("playback_zoom").getPrevious().addClass("fn-hide");if(!SHOW_TIPS&&IS_CGI_SEND){var a=(new RPCCall).getRequest("getEventnum",null);sendRequest(a,function(){});SHOW_TIPS=!0}onClearOCXFunction();resetAFEnable();$("b_focus").hasClass("main-top-icon-afocus-current")&&setfocus();$("videobar").setStyle("display",
"block");$("video_image_adjust").setStyle("display","none");$("image_adjust").setStyle("display","none");$("focus_adjust").setStyle("display","none");$("video_focus_adjust").hasClass("ui-video-icon-adjust-current")&&$("video_focus_adjust").removeClass("ui-video-icon-adjust-current");$$(".main-top").setStyle("display","");$("playback_left_bar").setStyle("display","none");$$("#page_filelist").setStyle("display","none");$("playback_bottom_bar").setStyle("display","none");resize();resize.delay(0);$$("#video_ivs_wrap .ui-video-wrap-item")[0].hasClass("ui-video-wrap-current")&&
$("ocx")&&$("ocx").SetIVSEnable(!0)}});$("b_playback").addEvent("click",function(){document.title=tl("w_Review");if(!Site.currentPage.isPlayBack){c.call(this);$$("#page_filelist,#go_page_calendarsearch").setStyle("display","none");$("go_page_fileList").setStyle("display","block");$("b_record").removeClass("main-top-icon-vedio-current");$("b_voice").removeClass("main-top-icon-voice-current");onClearOCXFunction();resetAFEnable();$("b_record").removeClass("main-top-icon-vedio-current");$("ocx")&&$("ocx").SetModuleMode(3);
$("video1").setStyles({top:"-10000px",left:"0px"});$("videoCon").setStyle("width","");$("videoH").setStyle("width","");$("mb").setStyles({top:"0px"});$("mb0").style.display="none";$("mb2").style.display="none";RE_OPEN_REAL_SUCCESS=!1;if(!SHOW_TIPS&&IS_CGI_SEND){var a=(new RPCCall).getRequest("getEventnum",null);sendRequest(a,function(){});SHOW_TIPS=!0}play_pre=play_state;$("button_bar").setStyle("display","none");$("ptz_help").style.display="none";$("videobar").setStyle("display","none");$("image_adjust").setStyle("display",
"none");$("focus_adjust").setStyle("display","none");$("ptz_control").setStyle("display","none");$("helpDIV").style.display="";$("ptz_help").style.display="none";$("playback_help").style.display="";if($("filetypeselect").value=="dav")$("playback_snap").style.display="",$("playback_zoom").style.display="",$("playback_snap").getPrevious().removeClass("fn-hide"),$("playback_zoom").getPrevious().removeClass("fn-hide");$("playback_left_bar").setStyle("display","block");$("playback_bottom_bar").setStyle("display",
"block");$("page_calendarsearch").setStyle("display","block");$("b_focus").hasClass("main-top-icon-afocus-current")&&setfocus();setTimeout(PlayBack.refreshData,0);$clear(alarmOutInterval);if(g_isHasfisheye)$("video_fisheye").style.display="none",$("fish_eye").style.display="none",$("playback_fisheye").setStyle("display","none");resize();resize.delay(0)}});$("b_config").addEvent("click",function(){isLoadSetContent=!1;document.title=tl("w_Setup");if(!Site.currentPage.isSetup)c.call(this),document.body.style.background=
"#191919",g_ptzflag=!1,g_getTiming&&$clear(g_getTiming),$("ocx")&&$("ocx").SetModuleMode(1),$("mb").setStyles({top:"-10000px"}),$("mb0").style.display="",$("mb2").style.display="none",$("video1").setStyles({top:"0px",left:"0px",width:450,height:337}),a.delay(20,this)});$("b_alarm").addEvent("click",b);$("d_alarmtip").addEvent("click",b);$("b_quit").addEvent("click",function(){isDDNS()?parent.location.href="http://"+getDDNSMessage().ddnshost:(showLogo(),$("m").style.top="-10000px",$("l").style.display=
"",document.body.style.background="#09548e",getsetting(),$("b_login").removeEvents("click").addEvent("click",login),$("b_talk").hasClass("main-top-icon-speak-current")&&stopTalk(),$("b_focus").hasClass("main-top-icon-afocus-current")&&($("b_focus").removeClass("main-top-icon-afocus-current"),$("ocx")&&$("ocx").SetAFEnable(!1),clearTimeout(timer_focus),timer_focus=0),$("video_ptz").hasClass("ui-video-icon-ptz-current")&&$("video_ptz").removeClass("ui-video-icon-ptz-current"),$("video_focus_adjust").hasClass("ui-video-icon-adjust-current")&&
$("video_focus_adjust").removeClass("ui-video-icon-adjust-current"),$("b_reset").fireEvent("click"),isIntellent&&rpcIDIT.start(function(){}),Page.videoDetectConfig&&Page.videoDetectConfig.logout&&Page.videoDetectConfig.logout(),$$("#set_page").dispose(),Page={},Cache={},setIconVisible(!0),resetAlarm(),onClearOCXFunction(),resetAFEnable(),doLogout(!0),PlayBack&&PlayBack.stop(),PlayBack&&PlayBack.logout(),WideView.support&&WideView.logoutWideView(),$("ocx")&&$("ocx").DisConnectRealVideo(0),$("ocx")&&
$("ocx").StopPlayBack(),$("ocx")&&$("ocx").LogoutDevice(),g_isHasfisheye&&FishEye.closeFishEye(),FishEye.isInit=!1,play_pre=play_state=0,$("b_Stream1").removeClass("ui-button-main-current"),$("b_Stream2").removeClass("ui-button-main-current"),$("b_Stream3").removeClass("ui-button-main-current"),$("video_image_adjust").className="ui-video-icon-image",$("video_WH").className="ui-video-icon-wh",$("video_quality").className="ui-video-icon-wh",$("video_fullscreen").className="ui-video-icon-wh",$("video_WH_origianl_size").className=
"ui-video-icon-per",$$(".ui-video-wrap").setStyle("display","none"),$("image_adjust").style.display="none",$$("#nav a").removeClass("main-nav-item-current"),$$("#nav1 a").removeClass("main-nav-item1-current"),$$("#playback_left_bar, #playback_bottom_bar").setStyle("display","none"),currenVendor=="RVi"?$$("#videoH, #videoCon, #video1").setStyle("width","1px"):$$("#videoH, #videoCon, #videobar, #video1").setStyle("width","1px"),clearInterval(g_aliveInterval),clearInterval(alarmOutInterval),clearTimeout(initPluginsWhenInstalled.timer),
clearInterval(keepActiveTime),$("video1").innerHTML="")})});
window.addEvent("domready",function(){autoFocusConfig.videoInput=new VideoInput;showLogo();isEnable("is_show_LDAP")?$("userType").setStyle("display",""):$("userType").setStyle("display","none");$("b_login").addEvent("click",login);$("password").addEvent("keydown",function(a){a.key=="enter"&&$("b_login").fireEvent("click")});$("username").addEvent("keyup",function(){this.value!=""&&(expressionCheck(8,this.value)?($("login_error_tip").addClass("fn-hide"),$("login_error_icon").addClass("fn-hide"),this.removeClass("login-input-error")):
($("login_error_tip").removeClass("fn-hide"),$("login_error_icon").removeClass("fn-hide"),this.addClass("login-input-error")))});$("video_image_adjust").addEvent("click",onVideoImageAdjustClick);$("video_WH_origianl_size").addEvent("click",onVideoWHOrigianlSizeClick);$("video_fullscreen").addEvent("click",onVideoFullscreenClick);$("video_WH").addEvent("click",onWHRateClick);$("video_quality").addEvent("click",onVideoQualityClick);$("video_IVS").addEvent("click",onVideoIVSClick);$$("#video_quality_wrap .ui-video-wrap-item").addEvent("click",
onVideoQualityLevelClick);$$("#video_ivs_wrap .ui-video-wrap-item").addEvent("click",onVideoIvsSetClick);$("video_WH_original_rate").addEvent("click",onVideoWHOriginalRateClick);$("video_WH_adaptive_window").addEvent("click",onVideoWHAdaptiveWindowClick);$("video_ptz").addEvent("click",onVideoPtzClick);$("video_focus_adjust").addEvent("click",onVideoFocusClick);$("video_fisheye").addEvent("click",onVideoFisheyeClick);$("video_svc").addEvent("click",onVideoSVCClick);$$("#video_svc_wrap .ui-video-wrap-item").addEvent("click",
onVideoSVCLevelClick);bindPtzEvents();gsld1=new FineSlider("sa1","sk1",{steps:128,wheel:!0,onChange:function(a){$("sa1").setProperty("title",a);$("t_sld1").setProperty("text",a);setcolors()}},"t_sld1","sk1_add","sk1_less");gsld2=new FineSlider("sa2","sk2",{steps:128,wheel:!0,onChange:function(a){$("sa2").setProperty("title",a);$("t_sld2").setProperty("text",a);setcolors()}},"t_sld2","sk2_add","sk2_less");gsld3=new FineSlider("sa3","sk3",{steps:128,wheel:!0,onChange:function(a){$("sa3").setProperty("title",
a);$("t_sld3").setProperty("text",a);setcolors()}},"t_sld3","sk3_add","sk3_less");gsld4=new FineSlider("sa4","sk4",{steps:128,wheel:!0,onChange:function(a){$("sa4").setProperty("title",a);$("t_sld4").setProperty("text",a);setcolors()}},"t_sld4","sk4_add","sk4_less");$("b_reset").addEvent("click",function(){gsld1.set(64);gsld2.set(64);gsld3.set(64);gsld4.set(64);gsld4.set(64)}).fireEvent("click");new Fx.Tween("gjxx","height",{duration:500});g_focusStatuss=1;g_zoomSlider=new Slider($("zoomL"),$("zoomS"),
{steps:2E3,wheel:!1,onChange:function(){},onComplete:function(a){g_zoomStep=a;b_stepSave?(isAutoFocus=!0,autoFocusConfig.saveZoomFocus()):b_stepSave=!0}});g_focusSlider=new Slider($("focusL"),$("focusS"),{steps:2E3,wheel:!1,onChange:function(){},onComplete:function(a){g_focusStep=a;g_lastFocusStep!=-1&&(g_focusSlider.set(g_lastFocusStep),b_stepSave=!1,g_lastFocusStep=-1);b_stepSave?autoFocusConfig.saveZoomFocus():b_stepSave=!0}});$("autoFocus").addEvent("click",autoFocusConfig.getautoFocus);$("restoryAll").addEvent("click",
autoFocusConfig.setRestoryAll);$("restartAll").addEvent("click",autoFocusConfig.setTimeAuto);$("reginFocus").addEvent("click",autoFocusConfig.reginFocus);$("zoomMore").addEvents({mousedown:function(a){preventM(a);autoFocusConfig.zoomContinue(1,0)},mouseup:function(a){preventM(a);autoFocusConfig.zoomEnd(1,0)},mouseout:function(a){preventM(a);autoFocusConfig.zoomEnd(1,0)}});$("zoomLess").addEvents({mousedown:function(a){preventM(a);autoFocusConfig.zoomContinue(-1,0)},mouseup:function(a){preventM(a);
autoFocusConfig.zoomEnd(-1,0)},mouseout:function(a){preventM(a);autoFocusConfig.zoomEnd(-1,0)}});$("focusMore").addEvents({mousedown:function(a){preventM(a);autoFocusConfig.zoomContinue(1,1)},mouseup:function(a){preventM(a);autoFocusConfig.zoomEnd(1,1)},mouseout:function(a){preventM(a);autoFocusConfig.zoomEnd(1,1)}});$("focusLess").addEvents({mousedown:function(a){preventM(a);autoFocusConfig.zoomContinue(-1,1)},mouseup:function(a){preventM(a);autoFocusConfig.zoomEnd(-1,1)},mouseout:function(a){preventM(a);
autoFocusConfig.zoomEnd(-1,1)}});$("zoomL").addEvent("mousedown",function(){g_isZoom=!0});$("focusL").addEvent("mousedown",function(){g_isZoom=!1});$("zoomEstop").addEvent("mousedown",function(a){a.stopPropagation()});$("focusEstop").addEvent("mousedown",function(a){a.stopPropagation()});$("zoomS").addEvent("mousedown",function(a){g_isZoom=!0;a.stopPropagation()});$("focusS").addEvent("mousedown",function(a){g_isZoom=!1;a.stopPropagation();g_dragStep=g_focusSlider.step;g_clearFocus=window.setInterval(function(){g_dragStep==
g_focusSlider.step&&g_focusState=="Normal"&&g_focusSlider.step!=g_lastFocusStep&&(g_lastFocusStep=g_focusStep=g_dragStep,autoFocusConfig.saveZoomFocus());g_dragStep=g_focusSlider.step},600);document.addEvent("mouseup",clearFocus)});$("image_adjust").style.display="none";$("focus_adjust").style.display="none";inilanguage();showlogin();getsetting();resetAlarm();loadPlugin();$("password").value="";if(isDDNS()){var a=getDDNSMessage();$("l").style.display="none";$("username").value=a.username;$("password").value=
a.password;$("s_logintype").empty();$("s_logintype").options.add(new Option("TCP",0));login()}else isAnonymous?($("l").style.display="none",$("username").value="",$("password").value="",login.delay(100)):$("username").value!=""?$("password").focus():$("username").focus();/:/.test(location.hostname)&&($("s_logintype").empty(),$("s_logintype").options.add(new Option("TCP",0)))});
function is8MFlash(){isEnable("is_8M_Flash")&&($("b_ab").setStyle("display","none"),$("b_b").setStyle("display","none"),$("m").addClass("hide-help"))}function VideoDisplayMode(){switch(Video.displayMode){case "Adaptive Window":$("video_WH_adaptive_window").fireEvent("click");break;case "Original Rate":$("video_WH_original_rate").fireEvent("click");break;case "Original Size":$("video_WH_origianl_size").fireEvent("click")}}Browser.ie||window.addEvent("beforeunload",function(){doLogout()});
window.addEvent("unload",function(){doLogout()});window.addEvent("resize",function(){videoResize(!0)});function clearFocus(){if(g_clearFocus&&(window.clearInterval(g_clearFocus),g_focusState!="Normal"))g_focusSlider.step=g_lastFocusStep;document.removeEvent("mouseup",clearFocus)}function showLogo(){document.title=tl("w_Login");Site.currentPage={};Site.currentPage.is={};Site.currentPage.isLogin=!0}
function login(){resize();$("b_login").removeEvents("click");var a=new RPCLogin,b=$("username").value,c=$("password").value;if(($("l").style.display=="none"||b==""&&c=="")&&isAnonymous)c=b="anonymity";var d=function(){settings.username=b;savesetting();getUserInfo();g_userInfo.PasswordModifiedTime=="1970-1-1 00:00:00"&&!(Cookie.read("pwdNoTip")-0)?openChangePwdDialog(c).then(afterlogin):afterlogin()};if(isEnable("is_show_LDAP")){g_loginType=$("slct_userType").selectedIndex==1?"ActiveDirectory":$("slct_userType").selectedIndex==
2?"LDAP":"Direct";var e=a.login(b,c,d,g_loginType)}else e=a.login(b,c,d);(function(){if(e!==1){switch(e){case -1:alert(tl("Password is error."));break;case -2:alert(tl("The user is not exited."));break;case -3:alert(tl("The user is locked."));break;case -4:alert(tl("The user is invalid."));break;case -5:alert(tl("The user has logined."));break;case -6:alert(tl("Login failure!"));break;case -7:alert(tl("the number of connection is maximal.request is refused!"));break;default:alert(tl("Login failure!"))}$("b_login").removeEvents("click").addEvent("click",
login);showlogin();if(isDDNS())$("username").value="",$("password").value="",$("l").style.display="block",$$("#s_logintype option").setStyle("display","block");$("l").style.display=""}}).delay(1E3)}
function getUserInfo(){var a=$("username").value,b=new UserManager;a==""&&isAnonymous&&(a="anonymity");var c=function(a,b){g_loginType=="LDAP"||g_loginType=="ActiveDirectory"?authorityList=b.params:(g_userInfo=b.params.user,authorityList=b.params.user.AuthorityList)};g_loginType=="LDAP"||g_loginType=="ActiveDirectory"?b.getAuthorityList(c,!1):b.getUserInfo(a,c,!1)}
function afterlogin(){var a=$("username").value,b=$("password").value;$("m").setStyle("display","block");base_pwd=Base64.encode(a+":"+b);document.body.style.background="#000000";pageInit();showPtzForSD();is8MFlash();$("b_preview").fireEvent("click");$("l").style.display="none";$("m").style.top="0px";$("mb").setStyles({top:"0px"});$("video1").setStyles({top:"0px",left:"0px"});$("ocx")||loadPlugin();if(hasPlugin&&$("ocx")){if(location.protocol.toLowerCase().contains("https"))Site.httpport=getHttpPort();
$("ocx").SetConfig("AuthorityList",JSON.encode(authorityList));$("ocx").RegisterTranslateFunc(tl);loginOCX()}else initPluginsWhenInstalled.timer=initPluginsWhenInstalled.delay(1E3);alive(300);g_aliveInterval=setInterval("alive(300)",6E4)}
function initPluginsWhenInstalled(){if(checkPlugins()){hasPlugin=!0;loadPlugin();if(location.protocol.toLowerCase().contains("https"))Site.httpport=getHttpPort();$("ocx").SetConfig("AuthorityList",JSON.encode(authorityList));$("ocx").RegisterTranslateFunc(tl);loginOCX();if(Site.currentPage.isPlayBack)$("ocx").SetModuleMode(3);else if(Site.currentPage.isSetup)Site.currentPage.is.cameraConfig&&Page.cameraConfig.render(),Site.currentPage.is.encodeConfig&&$("video_OSD_tab").hasClass("ui-tab-current")&&
Page.encodeConfig.render(),Site.currentPage.is.encodeConfig&&$("video_Intel_tab").hasClass("ui-tab-current")&&Page.encodeConfig.render(),Site.currentPage.is.videoDetectConfig&&$("videoDetect_motion").hasClass("ui-tab-current")&&$("videoDetect_zone").getStyle("top")!="-10000px"&&Page.videoDetectConfig.Tab.motionDetect._setZoneClick(),Site.currentPage.is.ipcIntellentConfig&&$$(".ipcintellent_tab_title.ui-tab-current").fireEvent("click"),Site.currentPage.is.intellentConfig&&$$("#wrap_page_intellentConfig .ivs_tab_title.ui-tab-current").fireEvent("click"),
Site.currentPage.is.ipcFacedectetionConfig&&$$(".ipc_face_tab_title.ui-tab-current").fireEvent("click"),Site.currentPage.is.ipcIntellentNewConfig&&$$(".ipcIntellentNew_tab_title.ui-tab-current").fireEvent("click"),Site.currentPage.is.ipcVideoDiagnosisConfig&&$$(".ipc_Diagnosis_tab_title.ui-tab-current").fireEvent("click"),Site.currentPage.is.ipcFaceNewConfig&&Page.ipcFaceNewConfig.render(),Site.currentPage.is.flowrateConfig&&$$(".flowrate_tab_title.ui-tab-current").fireEvent("click"),Site.currentPage.is.ipcIntellentCarConfig&&
$$(".ipcIntellentCar_tab_title.ui-tab-current").fireEvent("click"),Site.currentPage.is.ipcIntellTrafficConfig&&$$(".traffic_tab_title.ui-tab-current").fireEvent("click");else if(Site.currentPage.isPreview){$$("#video_ivs_wrap .ui-video-wrap-item")[0].hasClass("ui-video-wrap-current")&&$("ocx")&&$("ocx").SetIVSEnable(!0);FishEye.init();var a=$$("#video_quality_wrap .ui-video-wrap-current")[0].getProperty("data-buf");a&&(a=a.split(","),$("ocx").SetDelayTimeEx(a[0].toInt(),a[1].toInt()))}gca=gcb=gcc=
gcd=64}else initPluginsWhenInstalled.timer=initPluginsWhenInstalled.delay(1E3)}initPluginsWhenInstalled.timer=null;
function loginOCX(){var a=$("s_logintype").value-0;isEnable("is_show_LDAP")&&(g_loginType=="ActiveDirectory"?a=13:g_loginType=="LDAP"&&(a=12));var b=$("username").value,c=$("password").value;b==""&&c==""&&isAnonymous&&(c=b="anonymity");if(isDDNS()){var d=getDDNSMessage().devwebport-0;Site.hostname="127.0.0.1";Site.httpport=d}a=$("ocx").LoginDeviceEx(Site.hostname,Site.httpport,b,c,a);Cookie.write("DhWebAlarmNum",0,{duration:0,domain:""});if(a===0)SVAC.isSVAC&&(a=$$("#video_svc_wrap .ui-video-wrap-current")[0].getProperty("data-level")-
0,SVAC.isPwd&&$("ocx").SetDecodeKey(SVAC.pwd),SVAC.isSVC&&$("ocx").ChooseFrame(a)),$("ocx")&&$("ocx").SetModuleMode(0),connectMain(),syncConfigPath(),VideoDisplayMode(),$("ocx")&&$("ocx").SetDeviceMode(0,settings.talktype.toInt());else if(b=$("ocx"),b.parentNode.removeChild(b),alert(tl({"-1":"DNS Error",3:"Login is overtime.",7:"System is busying.",8:"Sub Connect Fail",9:"Main Connect Fail",10:"the number of connection is maximal.request is refused!"}[a]||"Login control failure!")),isDDNS()){parent.location.href=
"http://"+getDDNSMessage().ddnshost;return}$("password").value=""}function keepActiveInit(){if($("ocx")){try{$("ocx").EnableKeepAlive(!0)}catch(a){}clearInterval(keepActiveTime);keepActiveTime=function(){try{$("ocx").KeepAlive()}catch(a){}}.periodical(4E4)}}
function pageInit(){var a=new ConfigManager,b=new MagicBox,c=new UserManager,d=new DevVideoDetect,e=null;d.instance(0,function(a,b){e=b.result;d.getCaps(e,function(a,b){if(b.result)devVideoDetectCaps=b.params.caps,devVideoDetectCaps.UnFocusDetect?($("Type_4").set("text",tl("w_videoOn")),alarmEvent[4]=["VideoBlind","VideoUnFocus"]):(alarmEvent[4]=["VideoBlind"],$("Type_4").set("text",tl("w_Video Shelter"))),devVideoDetectCaps.SupportBlind||$("showAlarmType_4").setStyle("display","none")},!1)},!1);
b.getProductDef(["HasPtz","AutofocusPeak","IsLocalStore","MaxExtraStream","VideoAnalyse","IntelliTracker","PtzFunctionMenu","VolumeDetect","AnomalyDetect","MutationDetect","WideViewControl","PtzDirectionCalibration","DecodeBuf","ControlPTZOSDMenuViaApp"],saveProJson,!1);$("b_duck").style.display=currenDeviceType.contains("SD")&&isEnable("is_show_duck")?"":"none";currenDeviceType.contains("SD")&&isEnable("is_show_duck")?$("b_duck").getPrevious().removeClass("fn-hide"):$("b_duck").getPrevious().addClass("fn-hide");
$("b_duckdrawn").style.display=currenDeviceType.contains("SD")&&isEnable("is_show_duck")?"":"none";currenDeviceType.contains("SD")&&isEnable("is_show_duck")?$("b_duckdrawn").getPrevious().removeClass("fn-hide"):$("b_duckdrawn").getPrevious().addClass("fn-hide");$("duck_wrap").style.display=currenDeviceType.contains("SD")&&isEnable("is_show_duck")&&$("b_duckdrawn").hasClass("main-top-duck-draw-current")?"":"none";$("b_figure").style.display=currenDeviceType.contains("SD")&&isEnable("is_show_mousecontrolptz")?
"":"none";currenDeviceType.contains("SD")&&isEnable("is_show_mousecontrolptz")?$("b_figure").getPrevious().removeClass("fn-hide"):$("b_figure").getPrevious().addClass("fn-hide");currenVendor=="RVi"&&($("button_bar").grab($("videobar")),$("videobar").removeClass("ui-video-bar").setStyle("float","right"));$("b_rocker").style.display="none";$("b_rocker").getPrevious().addClass("fn-hide");currenDeviceType.contains("SD")||$("dir_control_nav").addClass("fn-hide");currenDeviceType.contains("SD")&&(new PtzCtrl).getCurrentProtocolCaps(function(a,
b){b.result&&b.params.caps.SupportRegionFocus&&($("b_reginFocus").removeClass("fn-hide"),$("b_reginFocus").getPrevious().removeClass("fn-hide"))});if($("ocx"))try{$("ocx").SetCommonCfg("3DLocation_Mode","New_3G_Protocol","")}catch(f){}keepActiveInit();showPtzFunction();b=$("username").value;b==""&&isAnonymous&&(b="anonymity");var k=function(a){authorityList=g_loginType=="LDAP"||g_loginType=="ActiveDirectory"?JSON.decode(a).params:JSON.decode(a).params.user.AuthorityList;if(checkAuthority("Alarm")){ALARM_OUT_NUMBER=
(new ChannelNumInfo).getAlarmOUT();(new ConfigManager).getConfig("AlarmOut",showAlarmChEx,!1);var b=new Alarm;b.getOutState(getAlarmOutState);alarmOutInterval=setInterval(function(){b.getOutState(getAlarmOutState)},5E3)}else $("b_almout0").getPrevious().addClass("fn-hide"),$$("#b_almout0, #b_almout1, #b_almout2").setStyle("display","none");if(checkAuthority("MPTZ")&&hasPtz){$("b_b").style.display="";if(currenDeviceType.contains("SD"))$("b_b").style.display="none";$("ytszSelect").value="xxsmCon";changePtzSetup("xxsmCon")}else $("b_b").style.display=
"none";checkAuthority("Replay_01")&&hasSDCard?($("b_ab").style.display="",PlayBack&&PlayBack.init()):$("b_ab").style.display="none";isEnable("is_8M_Flash")&&(ALARM_OUT_NUMBER=ALARM_IN_NUMBER=0)};g_loginType=="LDAP"||g_loginType=="ActiveDirectory"?c.getAuthorityList(k,!1):c.getUserInfo(b,k,!1);autoFocusConfig.getDevVideoInput();a.getConfig(["ChannelTitle","Encode","EncodeEncrypt","AlarmConfig"],saveJsonInfo,!1);getVoiceInfo();if(IPCIntellentShow||isIntellent)$$("#video_ivs_wrap .ui-video-wrap-item").removeClass("ui-video-wrap-current"),
$$("#video_ivs_wrap .ui-video-wrap-item")[0].addClass("ui-video-wrap-current"),$("video_ivs_wrap").style.display="none",$("video_IVS").removeClass("ui-video-icon-current"),function(){$("ocx")&&$("ocx").SetIVSEnable(!0)}.delay(500);isFLIR&&$("video_image_adjust").setStyle("display","none")}
function showPtzFunction(){var a="";$("ytszSelect_wrap").innerHTML="";a+='<select id="ytszSelect" class="ui-select main-ptzSet-select" onchange="changePtzSetup(this.value)">';a+='<option value="xxsmCon" data-trans="w_Auto-Scan">'+tl("w_Auto-Scan")+"</option>";a+='<option value="yzdCon" data-trans="w_Preset">'+tl("w_Preset")+"</option>";a+='<option value="xhzCon" data-trans="w_Auto-Tour">'+tl("w_Auto-Tour")+"</option>";a+='<option value="xjCon" data-trans="w_Pattern">'+tl("w_Pattern")+"</option>";
a+='<option value="fzCon" data-trans="Assistant">'+tl("Assistant")+"</option>";if(currenDeviceType.contains("SD")){a+='<option value="positionCon" data-trans="w_positionABS">'+tl("w_positionABS")+"</option>";var b=!0;(new CapsManager).get(0,["AutoPan","MoveAbsolutely"],function(a,d){if(d.result)d.params[0].result&&(b=d.params[0].params.caps.Support),d.params[1].result&&!("zoom"in(d.params[1].params.caps.PTZ||[]))&&$$("#positionCon .moveZoom").addClass("fn-hide")},!1);b&&(a+='<option value="AutoPanCon" data-trans="w_Auto-Pan">'+
tl("w_Auto-Pan")+"</option>");Ptz_Menu_Height=90;$("b_b").style.display="none"}else a+='<option value="dgCon" data-trans="LightWiper">'+tl("LightWiper")+"</option>";isEnable("is_show_azimuthDisp")&&(a+='<option value="zbShow" data-trans="w_AzimuthDisp">'+tl("w_AzimuthDisp")+"</option>");a+="</select>";$("ytszSelect_wrap").innerHTML=a;if(currenDeviceType.contains("IPC-HDB3200C"))$("b_b").style.display="none"}
function showPtzForSD(){currenDeviceType.contains("SD")&&checkAuthority("MPTZ")&&hasPtz?($("b_b").style.display="none",$("image_adjust").style.display="none",$("ptz_control").style.display="",$("video_ptz").addClass("ui-video-icon-current"),$("video_ptz").style.display="",limitPtzCtrl(),resize()):(checkAuthority("MPTZ")&&hasPtz&&limitPtzCtrl(),$("video_ptz").style.display="none",$("ptz_control").style.display="none")}
function onVideoStreamProtocolChange(){var a=$("s_logintype").value-0;isEnable("is_show_LDAP")&&(g_loginType=="ActiveDirectory"?a=13:g_loginType=="LDAP"&&(a=12));var b=$("username").value;b==""&&isAnonymous&&(b="anonymity");var c=Base64.decode(base_pwd).split(":")[1],d=0,d=$("b_Stream1").hasClass("ui-button-main-current")?1:$("b_Stream2").hasClass("ui-button-main-current")?2:$("b_Stream3").hasClass("ui-button-main-current")?3:0;onClearOCXFunction();resetAFEnable();$$("#b_Stream1,#b_Stream2,#b_Stream3").removeClass("ui-button-main-current");
resetIconState();$("b_talk").hasClass("main-top-icon-speak-current")&&stopTalk();$("ocx")&&$("ocx").LoginDeviceEx(Site.hostname,Site.httpport,b,c,a)===0&&(d==1?connectMain():d==2?connectExtra():d==3&&connectExtra2())}
function saveProJson(a){if(JSON.decode(a).result){a=JSON.decode(a).params;if(a[0].result)hasPtz=a[0].params.definition;if(a[1].result&&a[1].params.definition.length>0)$("b_focus").style.display="",$("b_focus").getPrevious().removeClass("fn-hide");if(a[2].result&&(hasSDCard=a[2].params.definition,!hasSDCard))$("showAlarmType_2").style.display="none",$("showAlarmType_3").style.display="none";if(a[3].result){var b=a[3].params.definition-0;if(b<1)Sys.ie?$("b_Stream2").disabled=!0:$("b_Stream2").style.display=
"none";if(b==2)$("b_Stream3").style.display="",$$("#b_Stream2").set("text",tl("w_SecondStream1")),$$("#b_Stream3").set("text",tl("w_SecondStream2"));if(b>1)$("chkExtraBtn").style.display="block"}if(a[4].result)isIntellent=a[4].params.definition.Support,support_scenes=a[4].params.definition.SupportScenes||[],isIntellent&&($("video_IVS_con").setStyle("display",""),$("video_IVS").set("title",tl("w_ivsRule"))),support_scenes.contains("Traffic")&&/^SD/.test(currenDeviceType)&&ManualEv.init(),/IPC/.test(currenDeviceType)&&
isIntellent?(IPCIntellentShow=!0,isIntellent=!1):/^SD/.test(currenDeviceType)&&isIntellent?(IPCIntellentShow=!1,isIntellent=!0):isIntellent=IPCIntellentShow=!1;if(a[5].result)$("b_locate").style.display=a[5].params.definition.Support?"":"none",a[5].params.definition.Support?$("b_locate").getPrevious().removeClass("fn-hide"):$("b_locate").getPrevious().addClass("fn-hide"),support_sceneTypes=a[5].params.definition.SupportCategory!==void 0?a[5].params.definition.SupportCategory:["SingleScene","MultiScene",
"FullScene"];if(a[6].result)(bool_PTZfunction=a[6].params.definition.Support)?($$("#b_xjset","#b_delxj","#b_xhset","#b_delxhz","#b_addyzd","#b_delyzd","#b_xsset").setStyle("display","none"),$("p_ptzset").set("text",tl("w_PTZFunction"))):$$("#b_xjset","#b_delxj","#b_xhset","#b_delxhz","#b_addyzd","#b_delyzd","#b_xsset").setStyle("display","");if(a[7].result)g_audioMangerCap.VolumeDetect=a[7].params.definition;if(a[8].result)g_audioMangerCap.AnomalyDetect=a[8].params.definition;if(a[9].result)g_audioMangerCap.MutationDetect=
a[9].params.definition;a[10].result&&a[10].params.definition.Support&&WideView.init();a[11].result&&a[11].params.definition.Support&&($("b_dirAdjust").removeClass("fn-hide"),$("b_dirAdjust").getPrevious().removeClass("fn-hide"));g_audioMangerCap.audioMangerCap=g_audioMangerCap.VolumeDetect||g_audioMangerCap.AnomalyDetect||g_audioMangerCap.MutationDetect;if(a[12].result)b=a[12].params.definition,$("ocx")&&$("ocx").SetDelayTimeEx(b[1][0].toInt(),b[1][1].toInt()),$("video_quality_realtime").setProperty("data-buf",
b[0].join(",")),$("video_quality_normal").setProperty("data-buf",b[1].join(",")),$("video_quality_fluency").setProperty("data-buf",b[2].join(","));a[13].result?a[13].params.definition&&$("p_ptzmenu").removeClass("fn-hide"):currenDeviceType.contains("SD")&&!bool_PTZfunction&&$("p_ptzmenu").removeClass("fn-hide")}}
function saveJsonInfo(a){if(JSON.decode(a).result){var a=JSON.decode(a).params,b=a[1].result&&a[1].params.table[0].MainFormat[0],c=a[2].result&&a[2].params.table[0][0];if(jsonAlarmConfig=a[3].result&&a[3].params.table){jsonAlarmConfig.AlarmEvent&&jsonAlarmConfig.AlarmEvent.each(function(a){a-=0;$("alarmType_"+a).checked=!0;attAlarmEvent(a)});if(jsonAlarmConfig.AlarmTip&&($("workType_3").checked=!0,$("alarm_frame").src==""||location.href.contains($("alarm_frame").src)))IS_CGI_SEND=!0,alarmCGI.open(),
alarm_timer=setInterval("showAlarmTips()",1E3);if(jsonAlarmConfig.AlarmSound){if(jsonAlarmConfig.AlarmSound.Enable)$("c_sound").checked=!0,chkAlarmSound();if(jsonAlarmConfig.AlarmSound.Path)$("i_chosepth").value=jsonAlarmConfig.AlarmSound.Path}}if(b&&c)SVAC.isSVAC=b.Video.Compression=="SVAC",SVAC.isSVC=b.Video.SVCTLayer-1,SVAC.isPwd=c.EncryptEnable,SVAC.pwd=c.Key}}
function getVoiceInfo(){var a=new RPCCall,b=a.getRequest("devAudioInput.factory.getCollect",null),c=a.getRequest("media.getAudioOutputDeviceChannels",null);a.doMutiCall(b+","+c,saveVoiceJson)}
function saveVoiceJson(a){if(JSON.decode(a).result){a=JSON.decode(a).params;if(a[0].result)g_audioInputNum=a[0].params.channels,g_audioInputNum==0?($("b_voice").style.display="none",$("b_voice").getPrevious().addClass("fn-hide")):g_audioInputNum==2?($("b_voice").removeClass("main-top-icon-voice"),$("b_voice").addClass("main-top-icon-doubleVoice1"),$("b_voice").style.display="",$("b_voice").getPrevious().removeClass("fn-hide"),$("b_voiceDouble").style.display="",$("b_voiceDouble").getPrevious().removeClass("fn-hide")):
($("b_voice").style.display="",$("b_voice").getPrevious().removeClass("fn-hide"));if(a[1].result&&(g_audioOutputNum=a[1].params.channels,g_audioOutputNum==0))$("b_talk").style.display="none",$("b_talk").getPrevious().style.display="none";g_audioInputNum==2&&audioInputPrev()}}
function audioInputPrev(){var a=new ConfigManager,b=new AudioInput;a.getConfig("AudioInput",function(a){if(JSON.decode(a).result){var d=JSON.decode(a).params.table[0].AudioSource;b.getSourceList(0,function(a){if(JSON.decode(a).result){var b=JSON.decode(a).params,a=b.caps.LineIn,b=b.caps.Mic;d=="LineIn"&&a<2||d=="Mic"&&b<2?($("b_voiceDouble").setStyle("display","none"),$("b_voiceDouble").getPrevious().addClass("fn-hide"),$("b_voiceDouble").hasClass("main-top-icon-doubleVoice2-current")&&($("b_voiceDouble").removeClass("main-top-icon-doubleVoice2-current"),
$("b_voiceDouble").addClass("main-top-icon-doubleVoice2"),ocx.SubVideoWndCtrl(15,0)),$("b_voice").removeClass("main-top-icon-doubleVoice1").addClass("main-top-icon-voice")):($("b_voice").removeClass("main-top-icon-voice").addClass("main-top-icon-doubleVoice1"),$("b_voiceDouble").setStyle("display",""),$("b_voiceDouble").getPrevious().removeClass("fn-hide"))}},!1)}})}
function setfocus(){var a=new ConfigManager;a.getConfig("VideoInOptions",function(a){if(JSON.decode(a).result)jsonVideoIn=JSON.decode(a).params.table},!1);if($("b_focus").hasClass("main-top-icon-afocus-current"))$("b_focus").removeClass("main-top-icon-afocus-current"),$("ocx")&&$("ocx").SetAFEnable(!1),clearTimeout(timer_focus),timer_focus=0;else if($("ocx")&&$("ocx").SetAFEnable(!0))$("b_focus").addClass("main-top-icon-afocus-current"),jsonVideoIn[0].FocusMode=1,timer_focus=setTimeout("stopFocus()",
3E5);a.setConfig("VideoInOptions",jsonVideoIn,saveInjson,!1)}function stopFocus(){$("b_focus").hasClass("main-top-icon-afocus-current")?setfocus():(clearTimeout(timer_focus),timer_focus=0)}function saveInjson(a){JSON.decode(a)}
function showAlarmChEx(a){var b=ALARM_OUT_NUMBER;if(JSON.decode(a).result)jsonAlarmOut=JSON.decode(a).params.table;if(b==0){if($("b_almout0"))$("b_almout0").getPrevious().addClass("fn-hide"),$("b_almout0").style.display="none"}else{if(b>1)for(a=1;a<b;a++)$("b_almout"+a)&&$("b_almout"+a).destroy();if(b>0){$("b_almout0").style.display="";$("b_almout0").getPrevious().removeClass("fn-hide");$("b_almout0")&&jsonAlarmOut[0].Mode==1?$("b_almout0").addClass("main-top-icon-alarm-current"):$("b_almout0").removeClass("main-top-icon-alarm-current");
b>1&&$("b_almout0").set("title",tl("w_Alarm Out")+1);navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.match(/9./i);for(a=b;a>1;a--)$("b_almout"+(a-1))||(Browser.ie9||Browser.ie10?(b=document.createElement("a"),b.setAttribute("id","b_almout"+(a-1)),b.setAttribute("class","main-top-icon-alarm"),b.setAttribute("hidefocus","true"),b.setAttribute("title",tl("w_Alarm Out")+a),$("button_bar").insertBefore(b,$("b_almout0"))):(b=new Element("a",{id:"b_almout"+(a-1),"class":"main-top-icon-alarm",
hidefocus:"true",onclick:"setAlarmOut("+(a-1)+")",title:tl("w_Alarm Out")+a}),b.inject($("b_almout0"),"before")),$("b_almout"+(a-1)).removeClass("main-top-icon-alarm-current")),jsonAlarmOut[a-1].Mode==1?$("b_almout"+(a-1)).addClass("main-top-icon-alarm-current"):$("b_almout"+(a-1)).removeClass("main-top-icon-alarm-current")}}}function getAlarmOutState(a){if(JSON.decode(a).result)alarmOutState=JSON.decode(a).params.state,showAlarmOutState()}
function showAlarmOutState(){for(var a=0;a<ALARM_OUT_NUMBER;a++)alarmOutState&1<<a?$("b_almout"+a).addClass("main-top-icon-alarm-current"):$("b_almout"+a).removeClass("main-top-icon-alarm-current")}
function setAlarmOut(a){var b=new ConfigManager;if(alarmOutState&1<<a){if($("b_almout"+a).hasClass("main-top-icon-alarm-current")){$("b_almout"+a).removeClass("main-top-icon-alarm-current");if(jsonAlarmOut[a].Mode!=1)jsonAlarmOut[a].Mode=1,b.setConfig("AlarmOut",jsonAlarmOut,function(){},!1);jsonAlarmOut[a].Mode=0}}else if(!$("b_almout"+a).hasClass("main-top-icon-alarm-current"))$("b_almout"+a).addClass("main-top-icon-alarm-current"),jsonAlarmOut[a].Mode=1;b.setConfig("AlarmOut",jsonAlarmOut,function(){},
!1);(new Alarm).getOutState(getAlarmOutState)}function reginFocus(a){a.hasClass("main-top-icon-reginfocus-current")?$("ocx").SubVideoWndCtrl(16,0)&&a.removeClass("main-top-icon-reginfocus-current"):(onClearOCXFunction(),$("ocx").SubVideoWndCtrl(16,1)&&a.addClass("main-top-icon-reginfocus-current"))}
function connectMain(){play_pre=0;onClearOCXFunction();resetAFEnable();Site.currentPage.isPreview&&(IPCIntellentShow||isIntellent)&&$("video_IVS_con").setStyle("display","");$$("#video_ivs_wrap .ui-video-wrap-item")[0].hasClass("ui-video-wrap-current")&&Site.currentPage.isPreview&&function(){$("ocx")&&$("ocx").SetIVSEnable(!0)}.delay(200);$("b_Stream1").hasClass("ui-button-main-current")?$("ocx")&&$("ocx").DisConnectRealVideo(0)&&($("b_Stream1").removeClass("ui-button-main-current"),play_state=0):
$("ocx")&&$("ocx").ConnectRealVideo(0,1)?($("b_Stream1").addClass("ui-button-main-current"),$("b_Stream2").removeClass("ui-button-main-current"),$("b_Stream3").removeClass("ui-button-main-current"),play_state=1):($("b_Stream1").removeClass("ui-button-main-current"),$("b_Stream2").removeClass("ui-button-main-current"),$("b_Stream3").removeClass("ui-button-main-current"),play_state=0);SVAC.isSVAC&&SVAC.isSVC?$("video_svc_con").setStyle("display","block"):$("video_svc_con").setStyle("display","none")}
function connectExtra(){$$("#video_ivs_wrap .ui-video-wrap-item")[0].hasClass("ui-video-wrap-current")&&$("ocx")&&$("ocx").SetIVSEnable(!1);play_pre=0;onClearOCXFunction();resetAFEnable();$("video_IVS_con").setStyle("display","none");$("video_svc_con").setStyle("display","none");$("b_Stream2").hasClass("ui-button-main-current")?$("ocx")&&$("ocx").DisConnectRealVideo(0)&&($("b_Stream2").removeClass("ui-button-main-current"),play_state=0):$("ocx")&&$("ocx").ConnectRealVideo(0,2)?($("b_Stream1").removeClass("ui-button-main-current"),
$("b_Stream2").addClass("ui-button-main-current"),$("b_Stream3").removeClass("ui-button-main-current"),play_state=2):($("b_Stream1").removeClass("ui-button-main-current"),$("b_Stream2").removeClass("ui-button-main-current"),$("b_Stream3").removeClass("ui-button-main-current"),play_state=0)}
function connectExtra2(){$$("#video_ivs_wrap .ui-video-wrap-item")[0].hasClass("ui-video-wrap-current")&&$("ocx")&&$("ocx").SetIVSEnable(!1);play_pre=0;onClearOCXFunction();resetAFEnable();$("video_IVS_con").setStyle("display","none");$("video_svc_con").setStyle("display","none");$("b_Stream3").hasClass("ui-button-main-current")?$("ocx")&&$("ocx").DisConnectRealVideo(0)&&($("b_Stream3").removeClass("ui-button-main-current"),play_state=0):$("ocx")&&$("ocx").ConnectRealVideo(0,3)?($("b_Stream1").removeClass("ui-button-main-current"),
$("b_Stream2").removeClass("ui-button-main-current"),$("b_Stream3").addClass("ui-button-main-current"),play_state=3):($("b_Stream1").removeClass("ui-button-main-current"),$("b_Stream2").removeClass("ui-button-main-current"),$("b_Stream3").removeClass("ui-button-main-current"),play_state=0)}
function resetAlarm(){alarmCGI.close();clearTimeout(alarm_timer);alarm_timer=0;$("d_alarmtip").style.display="none";$("alarmType_0").checked=!1;$("alarmType_1").checked=!1;$("alarmType_2").checked=!1;$("alarmType_3").checked=!1;$("alarmType_4").checked=!1;$("alarmType_5").checked=!1;$("alarmType_6").checked=!1;$("alarmType_7").checked=!1;$("alarmType_8").checked=!1;$("workType_3").checked=!1;$("c_sound").checked=!1;$("i_chosepth").value="";$("i_chosepth").disabled=!0;$("b_almpth").disabled=!0;$("b_almpth").addClass("ui-button-disabled")}
function showlogin(){$("l").style.top="0px";document.title=tl("w_Login")}function cptz(){play_state!=0&&!$("yt5").hasClass("ui-ptz-icon-center-current")?(onClearOCXFunction(),$("yt5").addClass("ui-ptz-icon-center-current"),$("ocx").SubVideoWndCtrl(11,1)):onClearOCXFunction()}
function stopPtz(){gxh==1&&(cptzd(!0,"StopTour",$("i_xhz").value-0,96,!1),gxh=0,$("b_xhz1_label").setProperty("text",tl("Start")));gxz==1&&(cptzd(!0,"AutoPanOff",0,0,!1),gxz=0);gxs==1&&(cptzd(!0,"AutoScanOff",0,0,!1),gxs=0);gxj==1&&(cptzd(!0,"StopPattern",$("i_xj").value-0,0,!1),gxj=0)}
function cxh(a,b,c){gst_sel!=1?alert(tl("Can't config PTZ of which channel is in the state of realplay!")):gxh==0?(stopPtz(),cptzd(!0,"StartTour",$("i_xhz").value-0,76,!1),gxh=1,a.setProperty("text",b)):(cptzd(!0,"StartTour",$("i_xhz").value-0,96,!1),gxh=0,a.setProperty("text",c))}
function cxz(a,b,c){gst_sel!=1?alert(tl("Can't config PTZ of which channel is in the state of realplay!")):gxz==0?(stopPtz(),cptzd(!0,"AutoPanOn",0,0,!1),gxz=1,a.setProperty("text",b)):(cptzd(!0,"AutoPanOff",0,0,!1),gxz=0,a.setProperty("text",c))}function cxs(a,b,c){gst_sel!=1?alert(tl("Can't config PTZ of which channel is in the state of realplay!")):gxs==0?(stopPtz(),cptzd(!0,"AutoScanOn",0,0,!1),gxs=1,a.setProperty("text",b)):(cptzd(!0,"AutoScanOff",0,0,!1),gxs=0,a.setProperty("text",c))}
function cxj(a,b,c){gst_sel!=1?alert(tl("Can't config PTZ of which channel is in the state of realplay!")):gxj==0?(stopPtz(),cptzd(!0,"StartPattern",$("i_xj").value-0,0,!1),gxj=1,a.setProperty("text",b)):(cptzd(!0,"StopPattern",$("i_xj").value-0,0,!1),gxj=0,a.setProperty("text",c))}
function ccd(a,b,c){gst_sel!=1?alert(tl("Can't config PTZ of which channel is in the state of realplay!")):gytcd==0?(cptzd(!0,"Menu",0,0,!1),gytcd=1,a.setProperty("text",b)):(cptzd(!0,"Exit",0,0,!1),gytcd=0,a.setProperty("text",c))}function cfz(a,b,c){gst_sel!=1?alert(tl("Can't config PTZ of which channel is in the state of realplay!")):gfz==0?(cptzd(!0,"AuxOn",0,0,!1),gfz=1,a.setProperty("text",b)):(cptzd(!0,"AuxOff",0,0,!1),gfz=0,a.setProperty("text",c))}
function setcolors(){$("ocx")&&$("ocx").SetColor(0,gsld1.slider.step,gsld2.slider.step,gsld3.slider.step,gsld4.slider.step)}
function syncConfigPath(){$("ocx")&&["LiveSnapshot","LiveRecord","PlaybackSnapshot","PlaybackRecord","VideoClips"].each(function(a,b){var c=b+1,d=$("ocx").GetConfigPath(c);d||(d=Cookie.read("DhWebVideoPath"+c)||(Browser.Platform.win?$("ocx").GetUserDirectory()+"\\WebDownload\\"+a:$("ocx").GetUserDirectory()+"/WebDownload/"+a),$("ocx").SetConfigPath(c,d));Cookie.write("DhWebVideoPath"+c,d,{duration:30})})}function savesetting(){HashCookie.extend(settings)}
function getsetting(){settings.username=HashCookie.get("username")||"";settings.pswd=HashCookie.get("pswd")||"";settings.talktype=HashCookie.get("talktype")||1;settings.logintype=HashCookie.get("logintype")||0;settings.username!=="anonymity"&&$("username").setProperty("value",settings.username)}
function setIconVisible(a){if(a){if(!currenDeviceType.contains("SD"))$("ptz_control").style.display="none";$("button_bar").style.display="block";$("helpDIV").style.display="none"}else{if(!currenDeviceType.contains("SD"))$("ptz_control").style.display="block";$("button_bar").style.display="none";$("helpDIV").style.display="block"}}
function limitPtzCtrl(){(new PtzCtrl).getCurrentProtocolCaps(function(a){if(JSON.decode(a).result&&JSON.decode(a).params){ptzCap=JSON.decode(a).params.caps;ptzCap==null&&(ptzCap={});attachLimit("i_yzd",ptzCap.PresetMin||0,ptzCap.PresetMax||255);$("title_minPreset").innerHTML=ptzCap.PresetMin||0;$("title_maxPreset").innerHTML=ptzCap.PresetMax||255;$("i_yzd").value=ptzCap.PresetMin||0;attachLimit("i_xhz",ptzCap.TourMin||1,ptzCap.TourMax||255);$("title_TourMin").innerHTML=ptzCap.TourMin||1;$("title_TourMax").innerHTML=
ptzCap.TourMax||255;$("i_xhz").value=ptzCap.TourMin||1;attachLimit("i_pnt",ptzCap.PresetMin||0,ptzCap.PresetMax||255);$("title_minPnt").innerHTML=ptzCap.PresetMin||0;$("title_maxPnt").innerHTML=ptzCap.PresetMax||255;$("i_pnt").value=ptzCap.PresetMin||0;attachLimit("i_xj",ptzCap.PatternMin||1,ptzCap.PatternMax||255);$("title_PatternMin").innerHTML=ptzCap.PatternMin||1;$("title_PatternMax").innerHTML=ptzCap.PatternMax||255;$("i_xj").value=ptzCap.PatternMin||1;attachLimit("i_fzz",ptzCap.AuxMin||1,ptzCap.AuxMax||
255);$("title_AuxMin").innerHTML=ptzCap.AuxMin||1;$("title_AuxMax").innerHTML=ptzCap.AuxMax||255;$("i_fzz").value=ptzCap.AuxMin||1;attachLimit("input_doubleValue",1,128);ptzCap.PtzMotionRange?($("title_xValueMin").innerHTML=ptzCap.PtzMotionRange.HorizontalAngle[0]*10,$("title_xValueMax").innerHTML=ptzCap.PtzMotionRange.HorizontalAngle[1]*10,$("title_yValueMin").innerHTML=ptzCap.PtzMotionRange.VerticalAngle[0]*10,$("title_yValueMax").innerHTML=ptzCap.PtzMotionRange.VerticalAngle[1]*10,attachLimit("input_xValue",
ptzCap.PtzMotionRange.HorizontalAngle[0]*10,ptzCap.PtzMotionRange.HorizontalAngle[1]*10),$("input_xValue").value=ptzCap.PtzMotionRange.HorizontalAngle[0]*10,ptzCap.PtzMotionRange.VerticalAngle[0]*10<0?attachLimit1("input_yValue",ptzCap.PtzMotionRange.VerticalAngle[0]*10,ptzCap.PtzMotionRange.VerticalAngle[1]*10):attachLimit("input_yValue",ptzCap.PtzMotionRange.VerticalAngle[0]*10,ptzCap.PtzMotionRange.VerticalAngle[1]*10),$("input_yValue").value=ptzCap.PtzMotionRange.VerticalAngle[0]*10):(attachLimit("input_xValue",
0,3600),$("input_xValue").value=0,attachLimit("input_yValue",0,900),$("input_yValue").value=0);typeof ptzCap.Zoom=="boolean"&&ptzCap.Zoom==!1&&$("ptz_bb_wrap").setStyle("display","none");typeof ptzCap.Focus=="boolean"&&ptzCap.Focus==!1&&$("ptz_bj_wrap").setStyle("display","none");typeof ptzCap.Iris=="boolean"&&ptzCap.Iris==!1&&$("ptz_gq_wrap").setStyle("display","none");if(currenDeviceType.contains("SD"))ptzCap.Tour===!1&&$$('#ytszSelect option[value="xhzCon"]').dispose(),ptzCap.Pattern===!1&&$$('#ytszSelect option[value="xjCon"]').dispose(),
ptzCap.MoveAbsolutely==!1&&$$('#ytszSelect option[value="positionCon"]').dispose();else{a="";$("ytszSelect_wrap").innerHTML="";a+='<select id="ytszSelect" class="ui-select main-ptzSet-select" onchange="changePtzSetup(this.value)">';if(typeof ptzCap.AutoScan=="boolean"&&ptzCap.AutoScan==!0||typeof ptzCap.AutoScan!="boolean")a+='<option value="xxsmCon" data-trans="w_Auto-Scan">'+tl("w_Auto-Scan")+"</option>";if(typeof ptzCap.Preset=="boolean"&&ptzCap.Preset==!0||typeof ptzCap.Preset!="boolean")a+='<option value="yzdCon" data-trans="w_Preset">'+
tl("w_Preset")+"</option>";if(typeof ptzCap.Tour=="boolean"&&ptzCap.Tour==!0||typeof ptzCap.Tour!="boolean")a+='<option value="xhzCon" data-trans="w_Auto-Tour">'+tl("w_Auto-Tour")+"</option>";if(typeof ptzCap.Pattern=="boolean"&&ptzCap.Pattern==!0||typeof ptzCap.Pattern!="boolean")a+='<option value="xjCon" data-trans="w_Pattern">'+tl("w_Pattern")+"</option>";if(typeof ptzCap.Aux=="boolean"&&ptzCap.Aux==!0||typeof ptzCap.Aux!="boolean")a+='<option value="fzCon" data-trans="Assistant">'+tl("Assistant")+
"</option>";if(typeof ptzCap.Wiper=="boolean"&&ptzCap.Wiper==!0||typeof ptzCap.Wiper!="boolean")a+='<option value="dgCon" data-trans="LightWiper">'+tl("LightWiper")+"</option>";a+="</select>";$("ytszSelect_wrap").innerHTML=a}changePtzSetup($("ytszSelect").value);ptzCap.Move&&!ptzCap.Move.contains("Directly")&&($("yt5").removeEvents("click"),$$("#yt5 i").removeClass("ui-ptz-icon-center").addClass("ui-ptz-icon-null"),$("yt5").set("title",""))}})}
function attachLimit1(a,b,c){a=$(a);a.removeEvents("keyup");a.removeEvents("blur");a.removeEvents("beforepaste");a.addEvents({blur:function(){limit1(this,c,b)},beforepaste:function(){clipboardData.setData("text",clipboardData.getData("text").match(/^[-]?\d+$/))}})}function limit1(a,b,c){var d=a.value;if(d!="")d=d.match(/^[-]?\d+$/)-0,a.value=d>b?b:d<=c?c:d}
function showAlarmTips(){if(SHOW_TIPS&&$("workType_3").checked){if($("alarmType_0").checked||$("alarmType_1").checked||$("alarmType_2").checked||$("alarmType_3").checked||$("alarmType_4").checked||$("alarmType_5").checked||$("alarmType_6").checked||$("alarmType_7").checked||$("alarmType_8").checked){var a=(new RPCCall).getRequest("getEventnum",null);sendRequest(a,retAlarmNum)}}else $("d_alarmtip").style.display="none"}
function retAlarmNum(a){var b=0;if(JSON.decode(a).result)b=JSON.decode(a).params.number;if(b>0&&!Site.currentPage.isLogin)$("d_alarmtip").style.display=""}
function startTalk(){if($("ocx"))if($("b_talk").hasClass("main-top-icon-speak-current"))$("ocx").ControlTalking(0)&&($("b_talk").removeClass("main-top-icon-speak-current"),$("b_talk").hasClass("main-top-icon-speak-connect")&&$("b_talk").removeClass("main-top-icon-speak-connect"));else{var a;(new ConfigManager).getConfig("Encode",function(b){b=JSON.decode(b).params.table;a=$("b_Stream2").hasClass("ui-button-main-current")?b[0].ExtraFormat[0].Audio:$("b_Stream3").hasClass("ui-button-main-current")?
b[0].ExtraFormat[1].Audio:b[0].MainFormat[0].Audio},!1);$("ocx").SetConfig("audio",JSON.encode(a));var b;(new ConfigManager).getConfig("Web",function(a){if(JSON.decode(a).result)b=JSON.decode(a).params.table},!1);$("ocx").SetConfig("audio",JSON.encode(b));$("ocx").ControlTalking(1)&&$("b_talk").addClass("main-top-icon-speak-current")}}
function stopTalk(){$("ocx")&&$("ocx").ControlTalking(0);$("b_talk").removeClass("main-top-icon-speak-current");$("b_talk").hasClass("main-top-icon-speak-connect")&&$("b_talk").removeClass("main-top-icon-speak-connect")}
function turnOnVoice(){g_audioInputNum==2?$("b_voice").hasClass("main-top-icon-doubleVoice1")?$("ocx").SubVideoWndCtrl(14,1)&&($("b_voice").removeClass("main-top-icon-doubleVoice1"),$("b_voice").addClass("main-top-icon-doubleVoice1-current")):$("ocx").SubVideoWndCtrl(14,0)&&($("b_voice").removeClass("main-top-icon-doubleVoice1-current"),$("b_voice").addClass("main-top-icon-doubleVoice1")):$("b_voice").hasClass("main-top-icon-voice-current")?$("ocx").SubVideoWndCtrl(1,0)&&$("b_voice").removeClass("main-top-icon-voice-current"):
$("ocx").SubVideoWndCtrl(1,1)&&$("b_voice").addClass("main-top-icon-voice-current")}function turnOnVoiceDouble(){$("b_voiceDouble").hasClass("main-top-icon-doubleVoice2")?ocx.SubVideoWndCtrl(15,1)&&($("b_voiceDouble").removeClass("main-top-icon-doubleVoice2"),$("b_voiceDouble").addClass("main-top-icon-doubleVoice2-current")):ocx.SubVideoWndCtrl(15,0)&&($("b_voiceDouble").removeClass("main-top-icon-doubleVoice2-current"),$("b_voiceDouble").addClass("main-top-icon-doubleVoice2"))}
function trackObject(){play_state!=0&&!$("b_locate").hasClass("main-top-icon-locate-current")?(onClearOCXFunction(),$("ocx").SubVideoWndCtrl(10,1),$("b_locate").addClass("main-top-icon-locate-current")):onClearOCXFunction()}function postIVSWindow(a,b,c,d){rpcIDIT.trackObject(-1,[a,b,c,d],function(){},!0)}
function beginRecord(){$("b_record").hasClass("main-top-icon-vedio-current")?$("ocx").SubVideoWndCtrl(3,0)&&$("b_record").removeClass("main-top-icon-vedio-current"):$("ocx").SubVideoWndCtrl(3,1)&&$("b_record").addClass("main-top-icon-vedio-current")}
window.addEvent("domready",function(){$$("#b_snap, #playback_snap").addEvents({click:function(){this.removeClass("main-top-icon-picture-hover");$("ocx")&&$("ocx").SubVideoWndCtrl(2,6)},mouseover:function(){this.addClass("main-top-icon-picture-hover")},mouseout:function(){this.removeClass("main-top-icon-picture-hover")}});$("b_3snap").addEvents({click:function(){this.removeClass("main-top-icon-picturethree-hover");$("ocx")&&$("ocx").SubVideoWndCtrl(9,1)},mouseover:function(){this.addClass("main-top-icon-picturethree-hover")},
mouseout:function(){this.removeClass("main-top-icon-picturethree-hover")}});$$("#b_range").addEvent("click",function(){if(this.hasClass("main-top-icon-big-current")){if($("ocx")&&$("ocx").SubVideoWndCtrl(5,0)&&(this.removeClass("main-top-icon-big-current"),$("b_Stream1").hasClass("ui-button-main-current")&&(IPCIntellentShow||isIntellent)))$("video_IVS_con").setStyle("display",""),$$("#video_ivs_wrap .ui-video-wrap-item")[0].hasClass("ui-video-wrap-current")&&$("ocx")&&$("ocx").SetIVSEnable(!0)}else $("ocx")&&
$("ocx").SubVideoWndCtrl(16,0)&&$("reginFocus").hasClass("ui-button-current")&&$("reginFocus").removeClass("ui-button-current"),$("ocx")&&$("ocx").SubVideoWndCtrl(5,1)&&($("video_IVS_con").setStyle("display","none"),$$("#video_ivs_wrap .ui-video-wrap-item")[0].hasClass("ui-video-wrap-current")&&$("b_Stream1").hasClass("ui-button-main-current")&&$("ocx")&&$("ocx").SetIVSEnable(!1),g_isHasfisheye&&$("video_fisheye").hasClass("ui-video-icon-current")&&FishEye.closeFishEye(),this.addClass("main-top-icon-big-current"))});
$("b_dirAdjust").addEvent("click",function(){rpcPtz.directionCalibration()})});function moveDirectly(a,b,c,d,e){var a=((b+d)/16384).limit(-1,1),f=((c+e)/16384).limit(-1,1),c=((Math.abs(e-c)>Math.abs(d-b)?e-c:d-b)/8192).limit(-1,1);rpcPtz.moveDirectly(function(){},[a,f,d>b?c*c:-1*c*c])}function setRange(a){play_state!=0&&!a.hasClass("main-top-icon-big-current")?(onClearOCXFunction(),$("ocx").SubVideoWndCtrl(5,1),a.addClass("main-top-icon-big-current")):onClearOCXFunction()}
function alarmoutCtrl(a){var b=a.id.replace(/[^\d]/g,"");a.hasClass("main-top-icon-alarm-current")?(a.removeClass("main-top-icon-alarm-current"),jsonAlarmOut[b].Mode=0):(a.addClass("main-top-icon-alarm-current"),jsonAlarmOut[b].Mode=1);(new ConfigManager).setConfig("AlarmOut",jsonAlarmOut,function(){})}
function resetIconState(){g_audioInputNum==2?($("ocx")&&$("ocx").SubVideoWndCtrl(1,0)&&$("ocx").SubVideoWndCtrl(0,0),$("b_voice").removeClass("main-top-icon-doubleVoice1-current"),$("b_voice").addClass("main-top-icon-doubleVoice1"),$("b_voiceDouble").removeClass("main-top-icon-doubleVoice2-current"),$("b_voiceDouble").addClass("main-top-icon-doubleVoice2")):$("b_voice").hasClass("main-top-icon-voice-current")&&($("ocx")&&$("ocx").SubVideoWndCtrl(1,0),$("b_voice").removeClass("main-top-icon-voice-current"),
$("b_voice").addClass("main-top-icon-voice"));$("b_record").hasClass("main-top-icon-vedio-current")&&($("ocx")&&$("ocx").SubVideoWndCtrl(3,0),$("b_record").removeClass("main-top-icon-vedio-current"),$("b_record").addClass("main-top-icon-vedio"))}
function inilanguage(){$("b_login").set("text",tl("w_Login"));$("t_UserType").set("text",tl("w_userType")+":");var a=$("slct_userType").getElements("option");a[0].setProperty("text",tl("w_localUser"));a[1].setProperty("text",tl("w_ADUser"));a[2].setProperty("text",tl("w_LDAPUser"));$("b_preview").set("text",tl("w_Preview"));$("b_playback").set("text",tl("w_Review"));$("b_config").set("text",tl("w_Setup"));$("b_alarm").set("text",tl("w_Alarm"));$("b_quit").set("text",tl("w_Logout"));$("b_Stream1").set("text",
tl("w_MainStream"));$("b_Stream3")&&$("b_Stream3").style.display!="none"?$("b_Stream2").set("text",tl("w_SecondStream1")):$("b_Stream2").set("text",tl("w_SecondStream"));$("b_Stream3").set("text",tl("w_SecondStream2"));$("t_bc").set("text",tl("w_Step")+"(1-8):");$("t_bb").set("text",tl("w_Zoom"));$("t_bj").set("text",tl("w_Focus"));$("t_gq").set("text",tl("w_Iris"));$("b_txtj").set("text",tl("w_Image Adjust Config"));$("b_reset").set("text",tl("w_Reset"));$$("#o_muticast").set("text",tl("w_multicast"));
$("alarmType").set("text",tl("w_Alarm Type"));$("Type_0").set("text",tl("w_Video Loss"));$("Type_1").set("text",tl("w_Motion Detect"));$("Type_2").set("text",tl("w_Disk-Full"));$("Type_3").set("text",tl("w_Disk-Error"));devVideoDetectCaps.UnFocusDetect?$("Type_4").set("text",tl("w_videoOn")):$("Type_4").set("text",tl("w_Video Shelter"));$("Type_5").set("text",tl("w_Extern Alarm"));$("Type_6").set("text",tl("w_unauthAccess"));$("Type_7").set("text",tl("w_audioDetect"));$("Type_8").set("text",tl("w_IVS"));
$("alarm_sound").set("text",tl("w_Alarm Sound"));$("play_alarm_sound").set("text",tl("w_Play Sound"));$("sound_path").set("text",tl("w_Sound Path"));$("b_almpth").set("text",tl("w_Select"));$("inedx_0").set("text",tl("w_Numbers"));$("time_0").set("text",tl("w_Time"));$("alarmTypeCGI").set("text",tl("w_Alarm Type"));$("alarmChannel").set("text",tl("w_Alarm Channel"));$("oprator_0").set("text",tl("w_Operation"));$("info_0").set("text",tl("w_Info"));$("w_streamprol").set("text",tl("Sub Stream Service"));
$("b_ptzctrl").set("text",tl("w_ptz"));$("b_talk").set("title",tl("w_btnaudiotalk"));$("b_voice").set("title",tl("w_btnaudio"));$("b_record").set("title",tl("w_Record"));$("b_snap").set("title",tl("w_Snap"));$("b_3snap").set("title",tl("w_3Snap"));$("b_range").set("title",tl("Local Range"));$("b_almout0").set("title",tl("w_Alarm Out"));$("b_reginFocus").set("title",tl("w_reginFocus"));$("b_dirAdjust").set("title",tl("w_directionCalibration"));$("b_focus").set("title",tl("w_aFocus"));$("b_locate").set("title",
tl("w_manualTrack"));$("img_ld").set("title",tl("w_Brightness"));$("img_db").set("title",tl("w_Contrast"));$("img_sc").set("title",tl("w_Chroma"));$("img_tm").set("title",tl("w_Saturation"));$("yt5").set("title",tl("w_Position"));$("b_help").set("title",tl("w_help"));$("alarm_help").set("title",tl("w_help"));$("ptz_help").set("title",tl("w_help"));$("playback_help").set("title",tl("w_help"));$("p_ptzset").set("text",tl("Set PTZ"));$("p_ptzmenu").set("text",tl("w_Menu"));$("p_visualPtz").set("text",
tl("w_PTZControl"));$("p_visualRock").set("text",tl("w_Joystick"));$("b_xxsm1_label").set("text",tl("Start"));$("b_xxsm2_label").set("text",tl("Stop"));$("b_xsset_label").set("text",tl("w_SetInPtz"));$("b_setleft").set("text",tl("Left Limit"));$("b_setright").set("text",tl("Right Limit"));$("b_yzd1_label").set("text",tl("w_Goto Preset"));$("b_yzdset_label").set("text",tl("w_Set Preset"));$("b_addyzd_label").set("text",tl("w_AddInPtz"));$("b_delyzd_label").set("text",tl("w_DelInPtz"));$("b_xhz1_label").set("text",
tl("Start"));$("b_xhz2_label").set("text",tl("Stop"));$("b_xhset_label").set("text",tl("w_AddInPtz"));$("b_delxhz_label").set("text",tl("w_DelInPtz"));$("b_addpnt").set("text",tl("w_Add Preset"));$("b_delpnt").set("text",tl("w_Del Preset"));$("b_xj1_label").set("text",tl("Start"));$("b_xj2_label").set("text",tl("Stop"));$("b_xjset_label").set("text",tl("w_AddInPtz"));$("b_delxj_label").set("text",tl("w_DelInPtz"));$("b_startjl").set("text",tl("pt_Start Record"));$("b_stopjl").set("text",tl("pt_Stop Record"));
$("b_fzk1").set("text",tl("w_AUX ON"));$("b_fzk2").set("text",tl("w_AUX OFF"));$("b_lighton").set("text",tl("C_On"));$("b_lightoff").set("text",tl("C_Off"));$("b_ctrlmenu").set("text",tl("w_openmenu"));$("b_ctrlmenu1").set("text",tl("w_closemenu"));$("b_enter").set("text",tl("Ok"));$("title_xValue").set("text",tl("w_xValue"));$("title_yValue").set("text",tl("w_yValue"));$("title_doubleValue").set("text",tl("w_Zoom"));$$('span[trans-id="title_xValue"]').set("text",tl("w_xValue"));$$('span[trans-id="title_yValue"]').set("text",
tl("w_yValue"));$$('span[trans-id="title_doubleValue"]').set("text",tl("w_Zoom"));$("btn_show_position").set("text",tl("w_AzimuthDispShowBtn"));$("btn_position").set("text",tl("GOTO"));$("btn_AutoPanOn_label").set("text",tl("Start"));$("btn_AutoPanOff_label").set("text",tl("Stop"));$("video_image_adjust").setProperty("title",tl("w_Image Adjust Config"));$("video_WH_origianl_size").setProperty("title",tl("FullRes Show"));$("video_fullscreen").setProperty("title",tl("Fullscreen Open"));$("video_WH").setProperty("title",
tl("WHRate"));$("video_ptz").set("title",tl("w_PtzLink"));$("video_WH_original_rate").set("text",tl("Original Rate"));$("video_WH_adaptive_window").set("text",tl("adapted window"));$("video_quality").setProperty("title",tl("Adjust fluency"));$("video_quality_realtime_label").set("text",tl("w_Real Time"));$("video_quality_normal_label").set("text",tl("w_Normal"));$("video_quality_fluency_label").set("text",tl("w_Fluency"));$("video_ivs_open").set("text",tl("C_On"));$("video_ivs_close").set("text",
tl("C_Off"));$("b_voiceDouble").set("title",tl("w_btnaudio"));$("video_svc_base_label").set("text",tl("w_baseLevel"));$("video_svc_enhancement_label").set("text",tl("w_enhancementLevel"));$("video_focus_adjust").setProperty("title",tl("w_zoomFocus"));$("t_zoomFocus").set("text",tl("w_zoomFocus"));$("t_zoom").set("text",tl("W_zoom"));$("t_step1").set("text",tl("w_Step"));$("t_step2").set("text",tl("w_Step"));$("t_focus").set("text",tl("W_focus"));$("t_autoFocus").set("text",tl("w_autoFocus"));$("restoryAll").set("text",
tl("w_restoryAll"));$("restartAll").set("text",tl("w_Refresh"));$("reginFocus").set("text",tl("w_reginFocus"));$("t_wide").set("text",tl("w_wide"));$("t_tele").set("text",tl("w_tele"));$("t_near").set("text",tl("w_near"));$("t_far").set("text",tl("w_far"));$("b_figure").set("title",tl("w_Figure"));$("b_duck").set("title",tl("w_Duck"));$("b_duck_red").set("title",tl("w_Red"));$("b_duck_blue").set("title",tl("w_Blue"));$("b_duck_green").set("title",tl("w_Green"));$("video_fisheye").set("title",tl("fisheyevideo"));
$("fisheye_fitMode_label").set("text",tl("w_fitMode"));$("fisheye_playMode_label").set("text",tl("fisheye_showmode"));$("fisheye_original_label").set("text",tl("fisheye_Original"));$("fisheye_original_label").set("title",tl("fisheye_Original"));$("fisheye_contrled_label").set("text",tl("fisheye_Panorama"));$("fisheye_contrled_label").set("title",tl("fisheye_Panorama"));$("fisheye_footStep_title").set("text",tl("fisheye_step"));$("fisheye_changeFocus_label").set("text",tl("w_Zoom"));$("fisheyeOCX_fitMode_label").set("text",
tl("w_fitMode"));$("fisheyeOCX_playMode_label").set("text",tl("fisheye_showmode"));for(var b=$("fisheye_playMode"),a=0;a<b.length;a++)b[a].text=tl("w_"+b[a].value);b=$("fisheye_fitMode");for(a=0;a<b.length;a++)for(var c in FishEye.MountModeMap)if(FishEye.MountModeMap[c]==b[a].value){b[a].text=tl("w_"+c);break}$("index_pwdDialog").translation()}function resize(){videoResize();videoResize()}
function videoResize(a){var b={width:document.documentElement.clientWidth||document.body.clientWidth,height:document.documentElement.clientHeight||document.body.clientHeight};if(!a||!(videoResize.width===b.width&&videoResize.height===b.height)){videoResize.width=b.width;videoResize.height=b.height;$$("#playback_pic").setStyle("display","none");if($("ocx"))$("ocx").style.top="0px";if(Site.currentPage.isSetup){Site.currentPage.is.intellentConfig&&($("video1").setStyle("width","400px"),$("video1").setStyle("height",
"300px"));currenVendor=="RVi"?$$("#videoCon,#videoH").setStyle("width",1E3):$$("#videoCon,#videoH,#videobar").setStyle("width",1E3);var a=$$(".set-sidebar").getStyle("height")[0],c=$$(".set-content").getStyle("height")[0];a&&(a=a.replace(/[^\d]/g,"")-0,c=c.replace(/[^\d]/g,"")-0,a=a+55>c?a+55:c,a+50>b.height-37?$$(".main-foot").setStyle("top",a+50+"px"):$$(".main-foot").setStyle("top",b.height-37))}else if(Site.currentPage.isAlarm)currenVendor=="RVi"?$$("#video1, #videoCon, #videoH").setStyle("width",
800):$$("#video1, #videoCon, #videoH, #videobar").setStyle("width",800),b.height-37<565?$$(".main-foot").setStyle("top","570px"):$$(".main-foot").setStyle("top",b.height-37);else if(Site.currentPage.isPlayBack){a=b.width-30-15-213;b=b.height-87-188;a<750&&(a=750);b<390&&(b=390);Browser.ie&&$("video1").setStyle("top","-10000px");if($("filetypeselect").value=="jpg"){if($("ocx"))$("ocx").style.top="-10000px";$$("#playback_pic").setStyle("display","block")}else{if($("ocx"))$("ocx").style.top="0px";$$("#playback_pic").setStyle("display",
"none")}$$(".playback-video-container").setStyles({height:b,width:"auto"});$$(".main-foot").setStyle("top",b+50+188);$("playback_left_bar").setStyle("height",b-15);$("playback_dates").setStyle("height",b-266>315?315:b-266);a/Video.rate<b?($("video1").setStyle("width",a),$$("#playback_pic").setStyle("width",a),$("video1").setStyle("height",a/Video.rate),$$("#playback_pic").setStyle("height",a/Video.rate),$("video1").setStyle("top",(b-a/Video.rate)/2)):($("video1").setStyle("height",b),$$("#playback_pic").setStyle("height",
b),$("video1").setStyle("width",b*Video.rate),$$("#playback_pic").setStyle("width",b*Video.rate),$("video1").setStyle("top","0px"));$("main_videobox").addClass("playback-video-container")}else if($("main_videobox").removeClass("playback-video-container"),Site.currentPage.isPreview||Site.currentPage.isPTZ){Browser.ie&&$("video1").setStyle("top","-10000px");var c=($("video_control_bar").getStyle("width").toInt()||-10)+10,d=b.width-30-c,a=b.height-87-40-42;currenVendor=="RVi"&&(a=b.height-87-40+24-42);
var e=a+45-30-15;e<180&&(e=180);Site.currentPage.isPTZ&&e<500&&(e=500);$$(".main-foot").setStyle("top",a+87+45);$("tj").setStyle("height",e);$("pev_cot").setStyle("height",e);$("videoH").setStyle("width","");switch(Video.displayMode){case "Adaptive Window":$("videoCon").setStyle("margin","0");break;case "Original Rate":d/Video.rate<a?a=d/Video.rate:d=a*Video.rate;$("videoH").setStyle("width",b.width-30);d+c+30<b.width?$("videoCon").setStyle("margin","0 auto"):$("videoCon").setStyle("margin","0");
break;case "Original Size":if(Video.resolution.x&&Video.resolution.y)Video.resolution.x+c+30<b.width?($("videoCon").setStyle("margin","0 auto"),$("videoH").setStyle("width",b.width-30)):($("videoCon").setStyle("margin","0"),c+=15),d=Video.resolution.x,a=Video.resolution.y}d=d>0?d:0;a=a>0?a:0;$("videoCon").setStyle("width",d+c);currenVendor!="RVi"&&$("videobar").setStyle("width",d);$("video1").setStyle("width",d);$("video1").setStyle("height",a);mbbw=d;mbbh=a;$("video1").setStyle("top","0px");g_isHasfisheye&&
Video.displayMode!="Original Size"&&(a=b.width-30-c,b=b.height-99-44,$("videoCon").setStyles({width:"auto",height:b+24}),$("main_videobox").setStyles({width:a,height:b+24}),$("video1").setStyles({width:a,height:b}),$("fisheyeOCX").setStyle("height",b+4),$("videobar").setStyle("bottom",0),$("videobar").setStyle("width",a))}}}function preventM(a){Sys.ie?document.documentElement.releaseCapture():(a?a:event).preventDefault()}
function changePtzBtn(){$("b_xxsm1").style.display="";$("b_xxsm2").style.display="none";$("b_xhz1").style.display="";$("b_xhz2").style.display="none";$("b_xj1").style.display="";$("b_xj2").style.display="none";$("btn_AutoPanOn").style.display="";$("btn_AutoPanOff").style.display="none"}
function onVideoImageAdjustClick(){$("reginFocus").hasClass("ui-button-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(16,0)&&$("reginFocus").removeClass("ui-button-current");$("video_image_adjust").hasClass("ui-video-icon-image-current")?($("video_image_adjust").removeClass("ui-video-icon-image-current"),$("image_adjust").style.display="none"):($("video_image_adjust").addClass("ui-video-icon-image-current"),$("image_adjust").style.display="");$("video_ptz").hasClass("ui-video-icon-current")?($("video_ptz").removeClass("ui-video-icon-current"),
$("ptz_control").style.display="none"):$("video_focus_adjust").hasClass("ui-video-icon-current")?($("focus_adjust").style.display="none",$("video_focus_adjust").removeClass("ui-video-icon-current")):$("video_fisheye").hasClass("ui-video-icon-current")?($("fish_eye").style.display="none",$("video_fisheye").removeClass("ui-video-icon-current"),FishEye.isOcxCorrect&&$("ocx")&&$("ocx").ControlFe(!1)):resize()}
function onVideoIVSClick(){$("video_IVS").hasClass("ui-video-icon-current")?($("video_IVS").removeClass("ui-video-icon-current"),$("video_ivs_wrap").style.display="none"):($("video_IVS").addClass("ui-video-icon-current"),$("video_ivs_wrap").style.display="",clearivsStyle())}function onVideoFullscreenClick(){$("ocx")&&$("ocx").OnFullScreenClk()}
function onVideoQualityClick(){$("video_quality").hasClass("ui-video-icon-quality-current")?($("video_quality").removeClass("ui-video-icon-quality-current"),$("video_quality_wrap").style.display="none"):($("video_quality").addClass("ui-video-icon-quality-current"),$("video_quality_wrap").style.display="",clearWHRateStyle())}
function onVideoIvsSetClick(){this.hasClass("ui-video-wrap-current")||(this.getProperty("data-enable").toInt()?$("ocx")&&$("ocx").SetIVSEnable(!0):$("ocx")&&$("ocx").SetIVSEnable(!1),$$("#video_ivs_wrap .ui-video-wrap-item").removeClass("ui-video-wrap-current"),this.addClass("ui-video-wrap-current"));$("video_ivs_wrap").style.display="none";$("video_IVS").removeClass("ui-video-icon-current")}
function onVideoQualityLevelClick(){if(!this.hasClass("ui-video-wrap-current")){var a=this.getProperty("data-level").toInt(),b=this.getProperty("data-buf");$("ocx")&&(b?(a=b.split(","),$("ocx").SetDelayTimeEx(a[0].toInt(),a[1].toInt())):$("ocx").SetDelayTime(a));onClearOCXFunction();$$("#video_quality_wrap .ui-video-wrap-item").removeClass("ui-video-wrap-current");this.addClass("ui-video-wrap-current")}$("video_quality_wrap").style.display="none";$("video_quality").removeClass("ui-video-icon-quality-current")}
function onWHRateClick(){$("video_WH").hasClass("ui-video-icon-wh-current")?($("video_WH").removeClass("ui-video-icon-wh-current"),$("video_WH_wrap").style.display="none"):($("video_WH").addClass("ui-video-icon-wh-current"),$("video_WH_wrap").style.display="",clearDelayTimeStyle())}
function onVideoPtzClick(){$("reginFocus").hasClass("ui-button-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(16,0)&&$("reginFocus").removeClass("ui-button-current");$("video_ptz").hasClass("ui-video-icon-current")?($("video_ptz").removeClass("ui-video-icon-current"),$("ptz_control").style.display="none"):($("video_ptz").addClass("ui-video-icon-current"),$("ptz_control").style.display="");$("video_image_adjust").hasClass("ui-video-icon-image-current")?($("image_adjust").style.display="none",$("video_image_adjust").removeClass("ui-video-icon-image-current")):
$("video_focus_adjust").hasClass("ui-video-icon-current")?($("focus_adjust").style.display="none",$("video_focus_adjust").removeClass("ui-video-icon-current")):$("video_fisheye").hasClass("ui-video-icon-current")?($("fish_eye").style.display="none",$("video_fisheye").removeClass("ui-video-icon-current")):resize()}
function onVideoFocusClick(){$("reginFocus").hasClass("ui-button-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(16,0)&&$("reginFocus").removeClass("ui-button-current");$("video_focus_adjust").hasClass("ui-video-icon-current")?($("focus_adjust").style.display="none",$("video_focus_adjust").removeClass("ui-video-icon-current")):($("video_focus_adjust").addClass("ui-video-icon-current"),$("g_zoomStep").value=20,$("g_focusStep").value=20,$("focus_adjust").style.display="");$("video_image_adjust").hasClass("ui-video-icon-image-current")?
($("image_adjust").style.display="none",$("video_image_adjust").removeClass("ui-video-icon-image-current")):$("video_ptz").hasClass("ui-video-icon-current")?($("ptz_control").style.display="none",$("video_image_adjust").removeClass("ui-video-icon-image-current")):$("video_fisheye").hasClass("ui-video-icon-image-current")?($("fish_eye").style.display="none",$("video_fisheye").removeClass("ui-video-icon-current")):resize()}
function onVideoWHOrigianlSizeClick(){$("video_WH_origianl_size").hasClass("ui-video-icon-per-current")?($("video_WH_origianl_size").removeClass("ui-video-icon-per-current"),$("video_WH_con").setStyle("display",""),$("video_WH_origianl_size").setProperty("title",tl("FullRes Show")),$("video_WH_adaptive_window").hasClass("ui-video-wrap-current")?$("video_WH_adaptive_window").fireEvent("click"):$("video_WH_original_rate").fireEvent("click")):($("video_WH_origianl_size").addClass("ui-video-icon-per-current"),
$("video_WH_con").setStyle("display","none"),$("video_WH_origianl_size").setProperty("title",tl("FullRes Hide")),clearWHRateStyle(),clearDelayTimeStyle(),Video.displayMode="Original Size",Cookie.write("DHVideoWHMode",Video.displayMode,{duration:30,path:"/"}),resize())}
function onVideoWHOriginalRateClick(){$("video_WH_wrap").style.display="none";$("video_WH").removeClass("ui-video-icon-wh-current");$$("#video_WH_wrap .ui-video-wrap-item").removeClass("ui-video-wrap-current");$("video_WH_original_rate").addClass("ui-video-wrap-current");Video.displayMode="Original Rate";g_isHasfisheye&&$("ocx")&&$("ocx").SetShowMode(1);Cookie.write("DHVideoWHMode",Video.displayMode,{duration:30,path:"/"});resize()}
function onVideoWHAdaptiveWindowClick(){$("video_WH_wrap").style.display="none";$("video_WH").removeClass("ui-video-icon-wh-current");$$("#video_WH_wrap .ui-video-wrap-item").removeClass("ui-video-wrap-current");$("video_WH_adaptive_window").addClass("ui-video-wrap-current");Video.displayMode="Adaptive Window";g_isHasfisheye&&$("ocx")&&$("ocx").SetShowMode(0);Cookie.write("DHVideoWHMode",Video.displayMode,{duration:30,path:"/"});resize()}
function onVideoSVCClick(){$("video_svc").hasClass("ui-video-icon-current")?($("video_svc").removeClass("ui-video-icon-current"),$("video_svc_wrap").style.display="none"):($("video_svc").addClass("ui-video-icon-current"),$("video_svc_wrap").style.display="")}
function onVideoSVCLevelClick(){if(!this.hasClass("ui-video-wrap-current")){var a=this.getProperty("data-level").toInt();$("ocx")&&$("ocx").ChooseFrame(a);$$("#video_svc_wrap .ui-video-wrap-item").removeClass("ui-video-wrap-current");this.addClass("ui-video-wrap-current")}$("video_svc_wrap").style.display="none";$("video_svc").removeClass("ui-video-icon-current")}
function clearWHRateStyle(){$("video_WH").removeClass("ui-video-icon-wh-current");$("video_WH_wrap").style.display="none";$("video_IVS").removeClass("ui-video-icon-current");$("video_ivs_wrap").style.display="none"}function clearDelayTimeStyle(){$("video_quality").removeClass("ui-video-icon-quality-current");$("video_quality_wrap").style.display="none";$("video_IVS").removeClass("ui-video-icon-current");$("video_ivs_wrap").style.display="none"}
function clearivsStyle(){$("video_quality").removeClass("ui-video-icon-current");$("video_quality_wrap").style.display="none";$("video_WH").removeClass("ui-video-icon-current");$("video_WH_wrap").style.display="none"}function checkAuthority(a){return a?authorityList.contains(a)?!0:!1:!0}
function changePtzSetup(a){$("xxsmCon").style.display="none";$("yzdCon").style.display="none";$("xhzCon").style.display="none";$("xjCon").style.display="none";$("fzCon").style.display="none";$("dgCon").style.display="none";$("positionCon").style.display="none";$("AutoPanCon").style.display="none";$("zbShow").style.display="none";$(a).style.display="";switch(a){case "yzdCon":if($("i_yzd").value=="")$("i_yzd").value=ptzCap.PresetMin||0;break;case "xhzCon":if($("i_xhz").value=="")$("i_xhz").value=ptzCap.TourMin||
1;break;case "xjCon":if($("i_xj").value=="")$("i_xj").value=ptzCap.PatternMin||1;break;case "fzCon":if($("i_fzz").value=="")$("i_fzz").value=ptzCap.AuxMin||1}}function showPtzset(a){$("d_ptzset"+a).style.display=="none"?$("d_ptzset"+a).style.display="":$("d_ptzset"+a).style.display="none";if(a==2&&$("i_pnt").value=="")$("i_pnt").value=ptzCap.PresetMin}
function showPtzSetTab(){$("cfgPTZ").style.display="";$("menuPTZ").style.display="none";$("p_ptzset").addClass("main-ptz-advance-nav-current");$("p_ptzmenu").removeClass("main-ptz-advance-nav-current")}function showPtzMenuTab(){$("menuPTZ").style.display="";$("cfgPTZ").style.display="none";$("p_ptzmenu").addClass("main-ptz-advance-nav-current");$("p_ptzset").removeClass("main-ptz-advance-nav-current")}
function showHelpDoc(){var a="";if(isDDNS())for(var a=getDDNSMessage(),b=a.resourcepath.split("_"),a="http://"+a.ddnshost+"/web",c=0;c<b.length;c++)a+="/"+b[c];var d;$("b_preview").hasClass("main-nav-item-current")?d="preview.htm":$("b_ptzctrl").hasClass("main-nav-item-current")?d="ptz.htm":$("b_playback").hasClass("main-nav-item-current")?d="playback.htm":$("b_alarm").hasClass("main-nav-item1-current")?d="alarm.htm":$("b_config").hasClass("main-nav-item1-current")&&(d=$$("#set li a.J_current").getProperty("data-filename")+
".htm");b=1;currenDeviceType.contains("SD")&&(b=2);window.open(Site.currentLanguage==="SimpChinese"?a+"/help/SimpChinese/"+d+"?device="+b:a+"/help/English/"+d+"?device="+b,"help"+rpcCore.sessionID,"width=601,height=500,menubar=no,status=no,toolbar=no,location=no,scrollbars=yes,resizable=no")}
function openVideo(){$("b_Stream1").hasClass("ui-button-main-current")?($("ocx")&&$("ocx").ConnectRealVideo(0,1),play_state=1,$$("#video_ivs_wrap .ui-video-wrap-item")[0].hasClass("ui-video-wrap-current")&&$("ocx")&&$("ocx").SetIVSEnable(!0)):$("b_Stream2").hasClass("ui-button-main-current")?($("ocx")&&$("ocx").ConnectRealVideo(0,2),play_state=2):$("b_Stream3").hasClass("ui-button-main-current")?($("ocx")&&$("ocx").ConnectRealVideo(0,3),play_state=3):!$("b_Stream1").hasClass("ui-button-main-current")&&
!$("b_Stream2").hasClass("ui-button-main-current")&&!$("b_Stream3").hasClass("ui-button-main-current")&&$("ocx")&&$("ocx").DisConnectRealVideo(0)}
function bindPtzEvents(){$$(".ptzControl").addEvents({mousedown:function(a){var b=this.get("data-direction");preventM(a);$(this.id).addClass("ptzCtrl"+b);cptzd(!0,b,$("ps").value-0,$("ps").value-0,!0);changePtzBtn()},mouseup:function(){var a=this.get("data-direction");$(this.id).removeClass("ptzCtrl"+a);cptzd(!1,a,$("ps").value-0,$("ps").value-0,!1)},mouseout:function(){var a=this.get("data-direction");$(this.id).removeClass("ptzCtrl"+a);cptzdEx(!1,a,$("ps").value-0,$("ps").value-0,!1)}});$("yt5").addEvent("click",
cptz);$("b_bb1").addEvent("mousedown",function(a){preventM(a);cptzd(!0,"ZoomTele",$("ps").value-0,0,!1);changePtzBtn()});$("b_bb1").addEvent("mouseup",function(){cptzd(!1,"ZoomTele",$("ps").value-0,0,!1)});$("b_bb1").addEvent("mouseout",function(){cptzdEx(!1,"ZoomTele",$("ps").value-0,0,!1)});$("b_bb2").addEvent("mousedown",function(a){preventM(a);cptzd(!0,"ZoomWide",$("ps").value-0,0,!1);changePtzBtn()});$("b_bb2").addEvent("mouseup",function(){cptzd(!1,"ZoomWide",$("ps").value-0,0,!1)});$("b_bb2").addEvent("mouseout",
function(){cptzdEx(!1,"ZoomWide",$("ps").value-0,0,!1)});$("b_bj2").addEvent("mousedown",function(a){preventM(a);cptzd(!0,"FocusFar",$("ps").value-0,0,!1);changePtzBtn()});$("b_bj2").addEvent("mouseup",function(){cptzd(!1,"FocusFar",$("ps").value-0,0,!1)});$("b_bj2").addEvent("mouseout",function(){cptzdEx(!1,"FocusFar",$("ps").value-0,0,!1)});$("b_bj1").addEvent("mousedown",function(a){preventM(a);cptzd(!0,"FocusNear",$("ps").value-0,0,!1);changePtzBtn()});$("b_bj1").addEvent("mouseup",function(){cptzd(!1,
"FocusNear",$("ps").value-0,0,!1)});$("b_bj1").addEvent("mouseout",function(){cptzdEx(!1,"FocusNear",$("ps").value-0,0,!1)});$("b_gq2").addEvent("mousedown",function(a){preventM(a);cptzd(!0,"IrisSmall",$("ps").value-0,0,!1);changePtzBtn()});$("b_gq2").addEvent("mouseup",function(){cptzd(!1,"IrisSmall",$("ps").value-0,0,!1)});$("b_gq2").addEvent("mouseout",function(){cptzdEx(!1,"IrisSmall",$("ps").value-0,0,!1)});$("b_gq1").addEvent("mousedown",function(a){preventM(a);cptzd(!0,"IrisLarge",$("ps").value-
0,0,!1);changePtzBtn()});$("b_gq1").addEvent("mouseup",function(){cptzd(!1,"IrisLarge",$("ps").value-0,0,!1)});$("b_gq1").addEvent("mouseout",function(){cptzdEx(!1,"IrisLarge",$("ps").value-0,0,!1)});$("p_ptzset").addEvent("click",showPtzSetTab);$("p_ptzmenu").addEvent("click",showPtzMenuTab);$("b_xxsm1").addEvent("click",function(){stopPtz();gxs=1;setTimeout("controlPtz(true, 'AutoScanOn', 0, 0, 0)",0);changePtzBtn();$("b_xxsm1").style.display="none";$("b_xxsm2").style.display=""});$("b_xxsm2").addEvent("click",
function(){gxs=0;controlPtz(!0,"AutoScanOff",0,0,0);$("b_xxsm1").style.display="";$("b_xxsm2").style.display="none"});$("b_setleft").addEvent("click",function(){controlPtz(!0,"SetLeftLimit",0,0,0)});$("b_setright").addEvent("click",function(){controlPtz(!0,"SetRightLimit",0,0,0)});$("b_yzd1").addEvent("click",function(){stopPtz();changePtzBtn();setTimeout("controlPtz(true, 'GotoPreset', $('i_yzd').value - 0, 0, 0)",0)});$("b_addyzd").addEvent("click",function(){controlPtz(!0,"SetPreset",$("i_yzd").value-
0,0,0)});$("b_delyzd").addEvent("click",function(){controlPtz(!0,"ClearPreset",$("i_yzd").value-0,0,0)});$("b_xhz1").addEvent("click",function(){stopPtz();gxh=1;setTimeout("controlPtz(true, 'StartTour', $('i_xhz').value - 0, 0, 0)",0);changePtzBtn();$("b_xhz1").style.display="none";$("b_xhz2").style.display=""});$("b_xhz2").addEvent("click",function(){gxh=0;controlPtz(!0,"StopTour",$("i_xhz").value-0,0,0);$("b_xhz1").style.display="";$("b_xhz2").style.display="none"});$("b_delxhz").addEvent("click",
function(){controlPtz(!0,"ClearTour",$("i_xhz").value-0,0,0)});$("b_addpnt").addEvent("click",function(){controlPtz(!0,"AddTour",$("i_xhz").value-0,$("i_pnt").value-0,0)});$("b_delpnt").addEvent("click",function(){controlPtz(!0,"DelTour",$("i_xhz").value-0,$("i_pnt").value-0,0)});$("b_xj1").addEvent("click",function(){stopPtz();gxj=1;setTimeout("controlPtz(true, 'StartPattern', $('i_xj').value - 0, 0, 0)",0);changePtzBtn();$("b_xj1").style.display="none";$("b_xj2").style.display=""});$("b_xj2").addEvent("click",
function(){gxj=0;controlPtz(!0,"StopPattern",$("i_xj").value-0,0,0);$("b_xj1").style.display="";$("b_xj2").style.display="none"});$("b_startjl").addEvent("click",function(){controlPtz(!0,"SetPatternBegin",$("i_xj").value-0,0,0)});$("b_stopjl").addEvent("click",function(){controlPtz(!0,"SetPatternEnd",$("i_xj").value-0,0,0)});$("b_delxj").addEvent("click",function(){controlPtz(!0,"ClearPattern",$("i_xj").value-0,0,0)});$("b_fzk1").addEvent("click",function(){controlPtz(!0,"AuxOn",$("i_fzz").value-
0,0,0)});$("b_fzk2").addEvent("click",function(){controlPtz(!0,"AuxOff",$("i_fzz").value-0,0,0)});$("b_lighton").addEvent("click",function(){controlPtz(!0,"LampWaterClear",1,0,0)});$("b_lightoff").addEvent("click",function(){controlPtz(!0,"LampWaterClear",0,0,0)});$("btn_AutoPanOn").addEvent("click",function(){stopPtz();gxz=1;setTimeout("controlPtz(true, 'AutoPanOn', 0, 0, 0)",0);changePtzBtn();$("btn_AutoPanOn").style.display="none";$("btn_AutoPanOff").style.display=""});$("btn_AutoPanOff").addEvent("click",
function(){gxz=0;controlPtz(!0,"AutoPanOff",0,0,0);$("btn_AutoPanOn").style.display="";$("btn_AutoPanOff").style.display="none"});$("btn_position").addEvent("click",function(){stopPtz();changePtzBtn();setTimeout("controlPtz(true, 'PositionABS', $('input_xValue').value - 0, $('input_yValue').value - 0, $('input_doubleValue').value - 0)",0)});$("b_xsset").addEvent("click",function(){showPtzset(0)});$("b_yzdset").addEvent("click",function(){showPtzset(1)});$("b_xhset").addEvent("click",function(){showPtzset(2)});
$("b_xjset").addEvent("click",function(){showPtzset(3)});$("b_fzset").addEvent("click",function(){showPtzset(4)});$("b_ctrlmenu").addEvent("click",function(){controlPtz(!0,"Menu",0,0,0)});$("b_ctrlmenu1").addEvent("click",function(){controlPtz(!0,"Exit",0,0,0)});$("boat1").addEvent("click",function(){controlPtz(!0,"MenuUp",0,0,0)});$("boat2").addEvent("click",function(){controlPtz(!0,"MenuLeft",0,0,0)});$("boat3").addEvent("click",function(){controlPtz(!0,"Enter",0,0,0)});$("b_enter").addEvent("click",
function(){controlPtz(!0,"Enter",0,0,0)});$("boat4").addEvent("click",function(){controlPtz(!0,"MenuRight",0,0,0)});$("boat5").addEvent("click",function(){controlPtz(!0,"MenuDown",0,0,0)});$("boat1x").addEvent("click",function(){controlPtz(!0,"MenuUp",0,0,0)});$("boat2x").addEvent("click",function(){controlPtz(!0,"MenuLeft",0,0,0)});$("boat3x").addEvent("click",function(){controlPtz(!0,"Enter",0,0,0)});$("boat4x").addEvent("click",function(){controlPtz(!0,"MenuRight",0,0,0)});$("boat5x").addEvent("click",
function(){controlPtz(!0,"MenuDown",0,0,0)});$("btn_show_position").addEvent("click",function(){$("btn_show_position").hasClass("ui-button-hover")?($("btn_show_position").removeClass("ui-button-hover"),$("btn_show_position").set("text",tl("w_AzimuthDispShowBtn"))):($("btn_show_position").addClass("ui-button-hover"),$("btn_show_position").set("text",tl("w_AzimuthDispShowBtn_stop")),pChangeValue())});$$("#pev_cot li[data-tab-nav]").addEvent("click",function(){var a=$(this).getProperty("data-tab-nav");
$$("#pev_cot li[data-tab-nav]").removeClass("main-ptz-advance-nav-current");$(this).addClass("main-ptz-advance-nav-current");$$("#pev_cot div[data-tab-content]").addClass("fn-hide");$$('#pev_cot div[data-tab-content="'+a+'"]').removeClass("fn-hide")});new Drag.Move("vR_contorl",{container:$("vR_area"),snap:2,onSnap:function(a){changePtzBtn();vRocker.init();var b=parseInt(a.style.left)-52,a=parseInt(a.style.top)-52;vRocker.checkInCircle({x:b,y:a},34);vRocker.getDirection(b,a);vRocker.getStepLength(b);
vRocker.getStepLength(a);vRocker.sendCommand(vRocker.direction,vRocker.stepLengthX,vRocker.stepLengthY);vRocker.startCommandTimer();vRocker.readCommandArr()},onDrag:function(a){vRocker.recordStatusOnce(a);Browser.ie7?($("vR_contorl").setStyle("cursor","move"),$("vR_area").setStyle("cursor","pointer")):($("vR_contorl").setStyle("cursor","none"),$("vR_area").setStyle("cursor","none"))},onComplete:function(){vRocker.commandnum<6?setTimeout(vRocker.endCollectCommand,300):vRocker.endCollectCommand();$("vR_contorl").set("style",
"");$("vR_contorl").setStyle("cursor","pointer");$("vR_area").setStyle("cursor","auto")}});$("vR_contorl").addEvent("mousewheel",function(a){var b=0.1*vRocker.getWheelDelta(a);rpcPtz.moveContinuouslyDirectly(function(){},0,0,!1,[0,0,b]);preventM(a)})}
var vRocker={direction:"None",stepLengthX:4,stepLengthY:4,timerCollectCommand:null,timerSendCommand:null,commandArr:[],commandnum:0,readComNum:0,comdirection:"None",comstepLengthX:2,comstepLengthY:2,pushdirection:"None",pushstepLengthX:3,pushstepLengthY:3,init:function(){vRocker.readComNum=0;vRocker.commandnum=0},startCommandTimer:function(){var a=[vRocker.direction,vRocker.stepLengthX,vRocker.stepLengthY];if(vRocker.direction!=vRocker.pushdirection||vRocker.stepLengthX!=vRocker.pushstepLengthX||
vRocker.stepLengthY!=vRocker.pushstepLengthY)vRocker.pushdirection=vRocker.direction,vRocker.pushstepLengthX=vRocker.stepLengthX,vRocker.pushstepLengthY=vRocker.stepLengthY,vRocker.commandArr.push(a);vRocker.timerCollectCommand=setTimeout(vRocker.startCommandTimer,50)},endCollectCommand:function(){clearTimeout(vRocker.timerCollectCommand);vRocker.commandArr.empty();vRocker.ptzStop()},readCommandArr:function(){var a=vRocker.commandArr.shift();if(a!=void 0)vRocker.readComNum=0,vRocker.sendCommand(a[0],
a[1],a[2]);else if(vRocker.readComNum<20)vRocker.readComNum++;else return;clearTimeout(vRocker.timerSendCommand);vRocker.timerSendCommand=setTimeout(vRocker.readCommandArr,500)},recordStatusOnce:function(a){var b=parseInt(a.style.left)-52,c=parseInt(a.style.top)-52,d={x:b,y:c},d=vRocker.checkInCircle(d,34);if(b!=d.x||c!=d.y)b=d.x,c=d.y,a.style.left=parseInt(b)+52+"px",a.style.top=parseInt(c)+52+"px";a=vRocker.getDirection(b,c);b=vRocker.getStepLength(b);c=vRocker.getStepLength(c);vRocker.recordStatus(a,
b,c);vRocker.commandnum++},recordStatus:function(a,b,c){vRocker.direction=a;vRocker.stepLengthX=b;vRocker.stepLengthY=c},sendCommand:function(a,b,c){if(a!=vRocker.comdirection||b!=vRocker.comstepLengthX||c!=vRocker.comstepLengthY)switch(vRocker.comstepLengthX=b,vRocker.comstepLengthY=c,vRocker.comdirection=a,this.comdirection){case "Up":cptzd(!0,vRocker.comdirection,vRocker.comstepLengthY,0,!0);break;case "Right":cptzd(!0,vRocker.comdirection,vRocker.comstepLengthX,0,!0);break;case "Down":cptzd(!0,
vRocker.comdirection,vRocker.comstepLengthY,0,!0);break;case "Left":cptzd(!0,vRocker.comdirection,vRocker.comstepLengthX,0,!0);break;default:a=((vRocker.comstepLengthY+vRocker.comstepLengthX)/2+1).round().limit(1,8),cptzd(!0,vRocker.comdirection,a,a,!0)}},ptzStop:function(){clearTimeout(vRocker.timerSendCommand);setTimeout(function(){cptzd(!1,vRocker.comdirection,vRocker.comstepLengthX,vRocker.comstepLengthY,!0)},450)},sendZoomCommand:function(a,b){switch(b){case "ZoomTele":cptzd(a,"ZoomTele",1,0,
0,!1);break;case "ZoomWide":cptzd(a,"ZoomWide",1,0,0,!1)}},getStepLength:function(a){var b=parseInt($("ps").value),a=Math.abs(a);return a>34?8:a>24&&a<34?6:a>14&&a<24?3:a>4&&a<14?2:1},getDirection:function(a,b){var c=["Down","Up","Right","Left","RightUp","RightDown","LeftUp","LeftDown","None"],d=Math.asin(b/Math.sqrt(a*a+b*b)),e=Math.PI/8;if(a>=0){if(!(d>e*3))if(d>=e&&d<=e*3)return c[5];else if(d>-e&&d<e)return c[2];else if(d<=-e&&d>=-e*3)return c[4];else if(d<-e*3)return c[1]}else if(a<0&&!(d>e*
3))if(d>=e&&d<=e*3)return c[7];else if(d>-e&&d<e)return c[3];else if(d<=-e&&d>=-e*3)return c[6];else if(d<-e*3)return c[1];return c[0]},checkInCircle:function(a,b){var c=Math.sqrt(a.x*a.x+a.y*a.y),d={x:a.x,y:a.y};if(c>b)d.x=a.x*b/c,d.y=a.y*b/c;return d},getWheelDelta:function(a){a=a.event;return a.wheelDelta?a.wheelDelta/120:a.detail/3}};
function pChangeValue(){Site.currentPage.isPreview&&$("zbShow").style.display!="none"&&$("btn_show_position").hasClass("ui-button-hover")?(rpcPtz.getStatus(function(a,b){if(b.result){var c=b.params.status.Postion,d=c[0]<0?(c[0]*1800+3600).round()/10:(c[0]*1800).round()/10;$("show_azimuth_x").value=d;c=(c[1]*-1800).round()/10;$("show_azimuth_y").value=c}}),pChangeValue.delay(200)):($("btn_show_position").removeClass("ui-button-hover"),$("btn_show_position").set("text",tl("w_AzimuthDispShowBtn")))}
function resetAFEnable(){$("b_focus")&&$("b_focus").hasClass("main-top-icon-afocus-current")&&($("b_focus").removeClass("main-top-icon-afocus-current"),$("ocx")&&$("ocx").SetAFEnable(!1),clearTimeout(timer_focus),timer_focus=0)}
function onClearOCXFunction(){$("b_range").hasClass("main-top-icon-big-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(5,0)&&($("b_Stream1").hasClass("ui-button-main-current")&&(IPCIntellentShow||isIntellent)&&$("video_IVS_con").setStyle("display",""),$("b_range").removeClass("main-top-icon-big-current"));$("playback_zoom")&&$("playback_zoom").hasClass("main-top-icon-big-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(5,0)&&$("playback_zoom").removeClass("main-top-icon-big-current");$("b_duck").hasClass("duckbtn")&&
$("ocx")&&$("ocx").SetMouseDrawEnable(0)&&($("b_duck").removeClass("main-top-icon-icon-duck-red"),$("b_duck").removeClass("main-top-icon-icon-duck-blue"),$("b_duck").removeClass("main-top-icon-icon-duck-green"),$("b_duck").removeClass("duckbtn"));isIntellent&&$("b_locate").hasClass("main-top-icon-locate-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(10,0)&&$("b_locate").removeClass("main-top-icon-locate-current");$("b_figure").hasClass("main-top-icon-figure-current")&&$("ocx")&&$("ocx").EnableMousePtz(0)&&
$("b_figure").removeClass("main-top-icon-figure-current");$("yt5").hasClass("ui-ptz-icon-center-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(11,0)&&$("yt5").removeClass("ui-ptz-icon-center-current");$("b_rocker").hasClass("main-top-icon-rocker-current")&&$("ocx")&&$("ocx").EnableMousePtz(0)&&$("b_rocker").removeClass("main-top-icon-rocker-current");$("b_reginFocus").hasClass("main-top-icon-reginfocus-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(16,0)&&$("b_reginFocus").removeClass("main-top-icon-reginfocus-current");
ManualEv.statusFlag&&ManualEv.varSetStatusFlag(!1)}
function onDuckClick(){play_state!=0&&$("b_duck").hasClass("main-top-icon-icon-duck")?$("b_duck").hasClass("duckbtn")?onClearOCXFunction():(onClearOCXFunction(),$("ocx").SetMouseDrawEnable(1),$("b_duck").addClass("duckbtn"),$("b_duck_red").hasClass("main-top-duckcheck")?($("b_duck").addClass("main-top-icon-icon-duck-red"),$("ocx").SetMouseDrawPen(233,16,42,0.8,5)):$("b_duck_blue").hasClass("main-top-duckcheck")?($("b_duck").addClass("main-top-icon-icon-duck-blue"),$("ocx").SetMouseDrawPen(4,20,236,
0.8,5)):($("b_duck").addClass("main-top-icon-icon-duck-green"),$("ocx").SetMouseDrawPen(6,245,45,0.8,5))):onClearOCXFunction()}function onDuckDrawnClick(){$("b_duckdrawn").toggleClass("main-top-duck-draw-current");$("duck_wrap").style.display=$("b_duckdrawn").hasClass("main-top-duck-draw-current")?"":"none";$("b_duckdrawn").hasClass("main-top-duck-draw-current")?$("duck_wrap").getPrevious().removeClass("fn-hide"):$("duck_wrap").getPrevious().addClass("fn-hide")}
function onDuckColorClick(a){if(play_state!=0)switch($("b_duckdrawn").toggleClass("main-top-duck-draw-current"),$("duck_wrap").style.display=$("b_duckdrawn").hasClass("main-top-duck-draw-current")?"":"none",$("b_duckdrawn").hasClass("main-top-duck-draw-current")?$("duck_wrap").getPrevious().removeClass("fn-hide"):$("duck_wrap").getPrevious().addClass("fn-hide"),$("b_duck").hasClass("duckbtn")||(onClearOCXFunction(),$("ocx").SetMouseDrawEnable(1),$("b_duck").addClass("duckbtn")),$$("#duck_wrap a").removeClass("main-top-duckcheck"),
$("b_duck").removeClass("main-top-icon-icon-duck-red").removeClass("main-top-icon-icon-duck-blue").removeClass("main-top-icon-icon-duck-green"),a){case 1:$("b_duck").addClass("main-top-icon-icon-duck-red");$("b_duck_red").addClass("main-top-duckcheck");$("ocx").SetMouseDrawPen(233,16,42,0.8,4);break;case 2:$("b_duck").addClass("main-top-icon-icon-duck-blue");$("b_duck_blue").addClass("main-top-duckcheck");$("ocx").SetMouseDrawPen(4,20,236,0.8,4);break;case 3:$("b_duck").addClass("main-top-icon-icon-duck-green"),
$("b_duck_green").addClass("main-top-duckcheck"),$("ocx").SetMouseDrawPen(6,245,45,0.8,4)}}function figureCtrl(){play_state!=0&&!$("b_figure").hasClass("main-top-icon-figure-current")?(onClearOCXFunction(),$("ocx").EnableMousePtz(1),$("b_figure").addClass("main-top-icon-figure-current")):onClearOCXFunction();changePtzBtn()}
function mouseCtrlPtzEvent(a,b,c,d,e){switch(a){case 3:c=(-1*d/20).limit(-1,1);rpcPtz.moveContinuouslyDirectly(function(){},mouseCtePTZNumber,0,!1,[0,0,c]);break;case 0:mouseCtrPTZArr.push([b,c,e])&&mouseCtrPTZArr.shift();a=(b/8192).limit(-1,1);c=(c/8192).limit(-1,1);(mouseCtePTZNumber=1)&&rpcPtz.moveContinuouslyDirectly(function(){},mouseCtePTZNumber,0,!1,[a,c,0]);break;case 1:Math.abs(e-mouseCtrPTZArr[2][2])>20&&mouseCtrPTZArr.push([b,c,e])&&mouseCtrPTZArr.shift();a=(b/8192).limit(-1,1);c=(c/8192).limit(-1,
1);b=mouseCtrPTZArr[2][2]-mouseCtrPTZArr[1][2];++mouseCtePTZNumber<256&&rpcPtz.moveContinuouslyDirectly(function(){},mouseCtePTZNumber,b,!0,[a,c,0]);break;case 2:mouseCtrPTZArr.push([b,c,e])&&mouseCtrPTZArr.shift(),a=(b/8192).limit(-1,1),c=(c/8192).limit(-1,1),b=mouseCtrPTZArr[2][2]-mouseCtrPTZArr[1][2],++mouseCtePTZNumber<256&&rpcPtz.moveContinuouslyDirectly(function(){},mouseCtePTZNumber,b,!1,[a,c,0])}}
function turnOnRocker(){play_state!=0&&!$("b_rocker").hasClass("main-top-icon-rocker-current")?(onClearOCXFunction(),$("b_rocker").addClass("main-top-icon-rocker-current"),$("ocx").EnableMousePtz(1)):onClearOCXFunction();changePtzBtn()}
var VisualRocker={direction:"None",step_length_x:4,step_length_y:4,down_point_x:0,down_point_y:0,MousePtzControlStatus:0,set_point_start:function(a,b){VisualRocker.down_point_x=a;VisualRocker.down_point_y=b;VisualRocker.MousePtzControlStatus=1},mouse_move:function(a,b){if(VisualRocker.MousePtzControlStatus==1){var c=a-parseInt(VisualRocker.down_point_x),d=b-parseInt(VisualRocker.down_point_y),e=this.get_step_length(c),f=this.get_step_length(d),c=VisualRocker.get_direction(c,d);if(c!=this.direction||
e!=this.step_length_x||f!=this.step_length_y)switch(this.step_length_x=e+1,this.step_length_y=f+1,this.direction=c,this.direction){case "Up":cptzd(!0,this.direction,this.step_length_y,0,!1);break;case "Right":cptzd(!0,this.direction,this.step_length_x,0,!1);break;case "Down":cptzd(!0,this.direction,this.step_length_y,0,!1);break;case "Left":cptzd(!0,this.direction,this.step_length_x,0,!1);break;default:cptzd(!0,this.direction,this.step_length_y,this.step_length_x,!1)}}else cptzd(!1,this.direction,
this.step_length_x,this.step_length_y,!1)},mouse_up:function(){cptzd(!1,this.direction,this.step_length_x,this.step_length_y,!1);VisualRocker.MousePtzControlStatus=0},get_step_length:function(a){var b=3,a=Math.abs(a);return a>5210?6:a>4810&&a<5210?5:a>2810&&a<4810?4:a>1010&&a<2810?3:2},get_direction:function(a,b){var c=["Up","Down","Right","Left","RightDown","RightUp","LeftDown","LeftUp","None"],a=Math.abs(a)<300?0:a,b=Math.abs(b)<300?0:b;if(a>0)if(b>0)return c[4];else if(b==0)return c[2];else{if(b<
0)return c[5]}else if(a==0)if(b>0)return c[1];else if(b==0)return c[8];else{if(b<0)return c[0]}else if(a<0)if(b>0)return c[6];else if(b==0)return c[3];else if(b<0)return c[7]}};function onVideoFisheyeClick(){FishEye.onVideoFishEyeClick()}
var FishEye={WinInfo:null,VideoInOptions:null,VideoInOptionsTemp:null,isInit:!1,isBind:!1,isShowchannelTitle:!1,isShowTimeTitle:!1,isFisheyeOpen:!1,isTmpVIORestored:!0,isRestoreConfig:!1,currFishModel:0,currFishWinID:1,currPTZStep:5,intervalId:-1,currMountMode:1,currCalibrateMode:0,currIsCorrect:"",isOcxCorrect:!0,MountModeMap:{CeilMode:1,WallMode:2,FloorMode:3},MountModeArr:["CeilMode","WallMode","FloorMode"],VideoInFishEye:null,osdSupport:{ChannelTitle:!1,TimeTitle:!1},VideoInOptionsOCX:null,init:function(){FishEye.isInit?
(g_isHasfisheye&&$("video_fisheye").setStyle("display",""),FishEye.checkFishEyeOpen(),FishEye.isFisheyeOpen?(!FishEye.isOcxCorrect&&$("video_fisheye").hasClass("ui-video-icon-current")?FishEye.getFishEyeConfig():FishEye.showCurrMode(),$("fish_eye").setStyle("display",""),FishEye.isTmpVIORestored=!1):$("fish_eye").setStyle("display","none")):(FishEye.getFishEyeCap(),g_isHasfisheye&&(FishEye.isBind||FishEye.bind(),FishEye.isOcxCorrect?(new ConfigManager).getConfig(["VideoWidget","VideoInOptions"],function(a,
b){if(b.result){var c=b.params[0].params.table[0];if(c)FishEye.osdSupport.ChannelTitle=c.ChannelTitle.EncodeBlend,FishEye.osdSupport.TimeTitle=c.TimeTitle.EncodeBlend;$("fisheyeOCX_fitMode").getChildren(".current").removeClass("current");FishEye.VideoInOptionsOCX=b.params[1].params.table;c=FishEye.VideoInOptionsOCX[0].FishEye.PlaceHolder;FishEye.currMountMode=c;$(FishEye.MountModeArr[c-1]).addClass("current");FishEye.showPlayModeByFitMode(FishEye.MountModeArr[c-1]);(function(){$("video_fisheye").fireEvent("click")}).delay(300)}},
!1):FishEye.getFishEyeConfig()),FishEye.isInit=!0)},bind:function(){FishEye.isOcxCorrect?($("fisheyeOCX_fitMode").addEvent("click",FishEye.onFitModeChange),$("fisheyeOCX_playMode").addEvent("click",FishEye.onPlayModeChange),$("video1")&&$("video1").addEvent("StateChanged",function(a,b){!b&&Site.currentPage.isPreview&&$("video_fisheye").hasClass("ui-video-icon-current")&&$("ocx").ControlFe(!1);b&&Site.currentPage.isPreview&&$("video_fisheye").hasClass("ui-video-icon-current")&&FishEye.showCurrMode()})):
($("fisheye_fitMode").addEvent("change",FishEye.onMountModeChange),$("fisheye_playMode").addEvent("change",function(){FishEye.onCalibrateModeChange(!0);this.disabled=!0;(function(){$("fisheye_playMode").disabled=!1}).delay(2E3)}),$("fisheye_original").addEvent("click",FishEye.onOriginalChange),$("fisheye_contrled").addEvent("click",FishEye.onContrledChange),$("fisheye_footStep").addEvent("change",function(){FishEye.currPTZStep=this.value-0;FishEye.setFisheyeStep(FishEye.currPTZStep)}),$("fisheye_boatX").getChildren("div[class^=ui-boat-box]").addEvent("mouseover",
function(a){if(a=(a.target||a.srcElement).getProperty("data-for")){var b=this.getParent();b.className="";b.addClass("ui-boat-current ui-boat-current-"+a.toLowerCase())}}),$("fisheye_boatX").addEvent("mouseout",function(){this.className="ui-boat-current"}),$("b_preview").addEvent("leave",function(){if(!FishEye.isTmpVIORestored)FishEye.restoreTempVideoInOptions(),$("fish_eye").style.display="none",FishEye.isTmpVIORestored=!0;var a=$("ocx");a&&(a.ShowChannelTittle(!1),a.ShowTimeTittle(!1))}),$("fisheye_boatX").addEvent("mousedown",
function(a){var b=(a.target||a.srcElement).getProperty("data-for");if(b)FishEye.setFishEyeEPtz(b,FishEye.currPTZStep),clearInterval(FishEye.intervalId),FishEye.intervalId=setInterval(function(){FishEye.setFishEyeEPtz(b,FishEye.currPTZStep)},500)}),$("fisheye_boatX").addEvent("mouseup",function(a){(a.target||a.srcElement).getProperty("data-for")&&clearInterval(FishEye.intervalId)}),$("fisheye_boatX").addEvent("mouseout",function(a){(a.target||a.srcElement).getProperty("data-for")&&clearInterval(FishEye.intervalId)}),
$("fisheye_lessFocus").addEvent("click",function(){FishEye.setFishEyeEPtz("ZoomOut",FishEye.currPTZStep)}),$("fisheye_moreFocus").addEvent("click",function(){FishEye.setFishEyeEPtz("ZoomIn",FishEye.currPTZStep)}),$("fisheye_RotateClock").addEvent("click",function(){FishEye.setFishEyeEPtz("RotateClock",FishEye.currPTZStep)}),$("fisheye_RotateAntiClock").addEvent("click",function(){FishEye.setFishEyeEPtz("RotateAntiClock",FishEye.currPTZStep)}));FishEye.isBind=!0},checkFishEyeOpen:function(){FishEye.isFisheyeOpen=
$("video_fisheye").hasClass("ui-video-icon-current")?!0:!1},onVideoFishEyeClick:function(){$("b_range").hasClass("main-top-icon-big-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(5,0)&&$("b_range").removeClass("main-top-icon-big-current");$("reginFocus").hasClass("ui-button-current")&&$("ocx")&&$("ocx").SubVideoWndCtrl(16,0)&&$("reginFocus").removeClass("ui-button-current");$("video_fisheye").hasClass("ui-video-icon-current")?($("video_fisheye").removeClass("ui-video-icon-current"),$("fish_eye").setStyle("display",
"none"),FishEye.isFisheyeOpen=!1):($("video_fisheye").addClass("ui-video-icon-current"),$("fish_eye").setStyle("display",""),FishEye.isFisheyeOpen=!0);if($("video_image_adjust").hasClass("ui-video-icon-image-current"))$("image_adjust").style.display="none",$("video_image_adjust").removeClass("ui-video-icon-imagecurrent");else if($("video_ptz").hasClass("ui-video-icon-ptz-current"))$("ptz_control").style.display="none",$("video_ptz").removeClass("ui-video-icon-ptz-current");else if($("video_focus_adjust").hasClass("ui-video-icon-adjust-current"))$("focus_adjust").style.display=
"none",$("video_focus_adjust").removeClass("ui-video-icon-adjust-current");resize();FishEye.isFisheyeOpen?FishEye.isOcxCorrect?FishEye.showCurrMode():FishEye.getFishEyeConfig():(FishEye.isOcxCorrect&&$("ocx")&&($("ocx").ControlFe(!1),$("ocx").ShowChannelTittle(!1),$("ocx").ShowTimeTittle(!1)),$("fish_eye").style.display="none",$("ocx")&&$("ocx").SetFisheyeParamsEx(0,0,0,0,0,0))},evaluate:function(){this.currMountMode=$("fisheye_fitMode").value;this.currCalibrateMode=$("fisheye_playMode").value;this.currIsCorrect=
$("fisheye_contrled").checked},getOcxCorrectModeValue:function(){var a=this.currMountMode,b=this.currCalibrateMode,c=this.currIsCorrect;return a==2&&b=="Panorama"?0:a==2&&b=="Single"&&c?13:a==2&&b=="FourEPtzRegion"&&c?14:a==2&&b=="OriginalPlusThreeEPtzRegion"?17:a==1&&b=="Panorama"?1:a==1&&b=="DoublePanorama"?2:a==1&&b=="Single"&&c?10:a==1&&b=="FourEPtzRegion"&&c?11:a==1&&b=="OriginalPlusThreeEPtzRegion"?18:a==3&&b=="Panorama"?3:a==3&&b=="DoublePanorama"?4:a==3&&b=="Single"&&c?15:a==3&&b=="FourEPtzRegion"&&
c?16:a==3&&b=="OriginalPlusThreeEPtzRegion"?19:12},closeFishEye:function(){$("ocx")&&(FishEye.isOcxCorrect?($("ocx").ControlFe(!1),$("ocx").ShowChannelTittle(!1),$("ocx").ShowTimeTittle(!1)):$("ocx").SetFisheyeParamsEx(0,0,0,0,0,0));if($("video_fisheye").hasClass("ui-video-icon-current"))$("video_fisheye").removeClass("ui-video-icon-current"),$("fish_eye").setStyle("display","none"),FishEye.isFisheyeOpen=!1,resize()},onMountModeChange:function(){if(FishEye.VideoInOptions&&FishEye.VideoInOptions[0].FishEye)FishEye.VideoInOptions[0].FishEye.PlaceHolder=
this.value-0;var a=$("fisheye_playMode"),b=FishEye.VideoInFishEye.CalibrateMode,c=a.value;a.empty();for(var d=0;d<b.length;d++)b[d]!="Config"&&(this.value==2&&b[d]=="DoublePanorama"||a.options.add(new Option(tl("w_"+b[d]),b[d])));if(b=a.getElement("option[value="+c+"]"))b.selected=!0;a.fireEvent("change")},onCalibrateModeChange:function(a){$("ocx")&&$("ocx").SetFisheyeParamsEx(0,0,0,0,0,0);if(FishEye.VideoInOptions&&FishEye.VideoInOptions[0].FishEye)FishEye.VideoInOptions[0].FishEye.CalibrateMode=
$("fisheye_playMode").value;var b=$("ocx")&&$("ocx").SubVideoWndCtrl(5,0);$("b_range").hasClass("main-top-icon-big-current")&&b&&$("b_range").removeClass("main-top-icon-big-current");$("fisheye_fitMode");b=$("fisheye_playMode").value;FishEye.isRestoreConfig=!1;switch(b){case "Single":FishEye.toogleControl(!0);if(a)$("fisheye_contrled").checked=!0;$("fisheye_original").checked?(FishEye.togglePTZ(!1),FishEye.currFishModel=1):(FishEye.isRestoreConfig=!0,FishEye.togglePTZ(!0),FishEye.currFishModel=5);
break;case "FourEPtzRegion":FishEye.toogleControl(!0);if(a)$("fisheye_contrled").checked=!0;$("fisheye_original").checked?(FishEye.togglePTZ(!1),FishEye.currFishModel=7):(FishEye.isRestoreConfig=!0,FishEye.togglePTZ(!0),FishEye.currFishModel=6);break;case "OriginalPlusThreeEPtzRegion":FishEye.toogleControl(!1);FishEye.togglePTZ(!0);FishEye.currFishModel=4;break;case "Original":FishEye.currFishModel=0;FishEye.toogleControl(!1);FishEye.togglePTZ(!1);break;case "Panorama":FishEye.currFishModel=5;FishEye.toogleControl(!1);
FishEye.togglePTZ(!1);break;case "DoublePanorama":FishEye.currFishModel=3;FishEye.toogleControl(!1);FishEye.togglePTZ(!1);break;case "Normal":FishEye.currFishModel=0,FishEye.toogleControl(!1),FishEye.togglePTZ(!1)}(b=="Single"||b=="FourEPtzRegion")&&$("fisheye_original").checked?(FishEye.VideoInOptionsTemp=$unlink(FishEye.VideoInOptions),FishEye.VideoInOptionsTemp[0].FishEye.CalibrateMode="Config",FishEye.setTempVideoInOptions(),FishEye.isTmpVIORestored=!1):(FishEye.isRestoreConfig&&FishEye.restoreTempVideoInOptions(),
FishEye.saveVideoInOptions())},onOriginalChange:function(){FishEye.onCalibrateModeChange()},onContrledChange:function(){FishEye.onCalibrateModeChange()},onOcxPaintRect:function(a,b,c,d,e){FishEye.currFishWinID=a;b==d||c==e?FishEye.setFishEyeEPtz("TapView",b,c):FishEye.setFishEyeEPtz("ShowRegion",parseInt((d+b)/2),parseInt((c+e)/2),d-b,e-c)},onOcxMouseWheelEvent:function(a,b,c,d,e){b===3&&(e>0?FishEye.setFishEyeEPtz("ZoomIn",FishEye.currPTZStep):FishEye.setFishEyeEPtz("ZoomOut",FishEye.currPTZStep))},
onFisheyeParamsEx:function(a,b,c,d,e,f){FishEye.currFishWinID=a;if(b==0&&c==0&&d==0&&e==0)f===1&&FishEye.setFisheyeParams();else{var k=new ConfigManager,j=$("fisheye_playMode").value,h=FishEye.WinInfo[0].Position;if(h[j]){for(var l=null,m=0;m<h[j].length;m++)if(h[j][m].WinID===FishEye.currFishWinID){l=h[j][m];break}l?(l.X=b,l.Y=c,l.HorizontalAngle=d,l.VerticalAngle=e):h[j].push({WinID:a,X:b,Y:c,HorizontalAngle:d,VerticalAngle:e})}else h[j]=[],h[j].push({WinID:a,X:b,Y:c,HorizontalAngle:d,VerticalAngle:e});
k.setConfig("FishEye",FishEye.WinInfo,function(a,b){b.result&&f===1&&FishEye.setFisheyeParams()})}},getFishEyeCap:function(){var a=new VideoInput;a.getCaps(function(b){b=JSON.decode(b);if(b.result)(g_isHasfisheye=!!b.params.caps.FishEye&&checkAuthority("VideoInputConfig"))?a.getCapsEx(function(a,b){$("video_fisheye").style.display="";FishEye.VideoInFishEye=b.params.caps.VideoInFishEye;FishEye.isOcxCorrect=FishEye.VideoInFishEye.Type=="Plugin";FishEye.isOcxCorrect?($("fisheyeOCX").setStyle("display",
"block"),Video.displayMode="Original Rate",$("video_WH_original_rate").fireEvent("click")):$("fisheyeDevice").setStyle("display","block");FishEye.render()},0,"ALL",!1):($("video_fisheye").style.display="none",$("fish_eye").setStyle("display","none"))},0,!1)},getFishEyeConfig:function(){g_isHasfisheye&&(new ConfigManager).getConfig(["VideoInOptions","FishEye"],function(a){if(JSON.decode(a).result)a=JSON.decode(a).params,FishEye.VideoInOptions=a[0].params.table,FishEye.WinInfo=a[1].params.table,(a=
FishEye.VideoInOptions[0].FishEye)?($("fisheye_fitMode").value=a.PlaceHolder,$("fisheye_playMode").value=a.CalibrateMode,$("fisheye_fitMode").fireEvent("change")):(g_isHasfisheye=!1,$("fish_eye").style.display="none")},!1)},setFishEyeEPtz:function(a,b,c,d,e){(new VideoInput).setFishEyeEPtz(0,FishEye.currFishWinID,a,b||0,c||0,d||0,e||0);a!=="TapView"&&FishEye.setFisheyeParams()},setFisheyeParams:function(a){(new VideoInput).getFishEyeWinInfo(0,[1,2,3,4],function(b){b=JSON.decode(b);if(b.result){for(var b=
b.params.winInfo,c=0;c<b.length;c++)$("ocx")&&$("ocx").SetFisheyeParamsEx(b[c].winID,b[c].focusX,b[c].focusY,b[c].hAngle,b[c].vAngle,FishEye.currFishModel);a&&(new ConfigManager).getConfig("FishEye",function(a,b){if(b.result)FishEye.WinInfo=b.params.table})}})},setFisheyeStep:function(a){$("ocx")&&$("ocx").SetFisheyeStep(a)},render:function(){if(FishEye.isOcxCorrect)for(var a=FishEye.VideoInFishEye.MountMode,b=0;b<a.length;b++)$(a[b]).setStyle("display","block"),$(a[b]).setProperty("data-for",FishEye.MountModeMap[a[b]]);
else{$("fisheye_fitMode").empty();a=FishEye.VideoInFishEye.MountMode;for(b=0;b<a.length;b++)$("fisheye_fitMode").options.add(new Option(tl("w_"+a[b]),FishEye.MountModeMap[a[b]]));$("fisheye_playMode").empty();a=FishEye.VideoInFishEye.CalibrateMode;for(b=0;b<a.length;b++)a[b]!="Config"&&$("fisheye_playMode").options.add(new Option(tl("w_"+a[b]),a[b]))}},toogleControl:function(a){$("fisheye_contrled_mode").style.display=a?"block":"none"},togglePTZ:function(a){var b=!1;if(FishEye.VideoInFishEye.EPtzCmd.contains("Up")||
FishEye.VideoInFishEye.EPtzCmd.contains("Down")||FishEye.VideoInFishEye.EPtzCmd.contains("Left")||FishEye.VideoInFishEye.EPtzCmd.contains("Right"))$("fisheye_boat").style.display=a?"block":"none",b=!0;if(FishEye.VideoInFishEye.EPtzCmd.contains("ZoomIn")||FishEye.VideoInFishEye.EPtzCmd.contains("ZoomOut"))$("fisheye_focus").style.display=a?"block":"none",b=!0;if(FishEye.VideoInFishEye.EPtzCmd.contains("RotateClock")||FishEye.VideoInFishEye.EPtzCmd.contains("RotateAntiClock"))$("fisheye_around").style.display=
a?"block":"none",b=!0;if(b)$("fisheye_footStep_wrap").style.display=a?"block":"none"},saveVideoInOptions:function(){var a=new ConfigManager,b=FishEye.VideoInOptions[0];if(b.FishEye.CalibrateMode!="Original"){if(b.Backlight==2)b.Backlight=0;if(b.NightOptions.Backlight==2)b.Backlight=0;if(b.NormalOptions.Backlight==2)b.Backlight=0}a.setConfig("VideoInOptions",FishEye.VideoInOptions,function(a,b){b.result&&FishEye.setFisheyeParams()})},setTempVideoInOptions:function(){(new ConfigManager).setTemporaryConfig("VideoInOptions",
FishEye.VideoInOptionsTemp,function(a,b){b.result&&FishEye.setFisheyeParams()})},restoreTempVideoInOptions:function(){(new ConfigManager).restoreTemporaryConfig("VideoInOptions",function(){})},onFitModeChange:function(a){a=a||window.event;a=a.target||a.srcElement;if(a.tagName=="LI"){this.getChildren(".current").removeClass("current");var b=a.getProperty("data-for");a.addClass("current");FishEye.showPlayModeByFitMode(FishEye.MountModeArr[b-1]);FishEye.currMountMode=b-0;$("ocx")&&$("ocx").SetFeInstallMode(FishEye.currMountMode);
$("fisheyeOCX_playMode").getChildren(".current").removeClass("current");$$("#fisheyeOCX_playMode li")[0].addClass("current");FishEye.currCalibrateMode=0;$("ocx")&&$("ocx").SetFeShowMode(FishEye.currCalibrateMode);FishEye.VideoInOptionsOCX[0].FishEye.PlaceHolder=FishEye.currMountMode;(new ConfigManager).setConfig("VideoInOptions",FishEye.VideoInOptionsOCX,function(){})}},onPlayModeChange:function(a){a=a||window.event;a=a.target||a.srcElement;if(a.tagName=="LI")this.getChildren(".current").removeClass("current"),
a.addClass("current"),FishEye.currCalibrateMode=a.getProperty("data-for")-0,$("ocx")&&$("ocx").SetFeShowMode(FishEye.currCalibrateMode)},showPlayModeByFitMode:function(a){$("fisheyeOCX_playMode").getChildren("li").each(function(b){b.style.display=b.getProperty("support-for").indexOf(a)>-1?"block":"none"})},showCurrMode:function(){$("fisheyeOCX_playMode").getChildren(".current").removeClass("current");$$("#fisheyeOCX_playMode li")[0].addClass("current");FishEye.currCalibrateMode=0;$("ocx")&&($("ocx").ControlFe(!0),
$("ocx").SetFeInstallMode(FishEye.currMountMode),$("ocx").SetFeShowMode(FishEye.currCalibrateMode))}},WideView={support:!1,isShowIcon:!1,isShow:!1,iconActived:!1,rpcConfig:null,init:function(){WideView.rpcConfig=new ConfigManager;WideView.bind();$("video_wideview").set("title",tl("WideView"));WideView.varSetSupport(!0)},bind:function(){$("video_wideview").removeEvents("click").addEvent("click",function(){if(WideView.iconActived!==0)WideView.iconActived=WideView.loginWideView();if(WideView.iconActived===
0)WideView.uichange(),WideView.ocxChange(),WideView.isShow=!WideView.isShow})},loginWideView:function(){var a=$("s_logintype").value-0;isEnable("is_show_LDAP")&&(g_loginType=="ActiveDirectory"?a=13:g_loginType=="LDAP"&&(a=12));var b=$("username").value,c=Base64.decode(base_pwd).split(":")[1];b==""&&c==""&&isAnonymous&&(c=b="anonymity");if(a=$("ocx").LoginWideView(Site.hostname,Site.httpport,b,c,a))b={1:tl("Password is error."),2:tl("The user is not exited."),3:tl("Login is overtime."),4:tl("The user has logined."),
5:tl("The user is locked."),6:tl("The user is invalid."),7:tl("System is busying."),8:tl("Sub Connect Fail"),9:tl("Main Connect Fail"),10:tl("the number of connection is maximal.request is refused!")},alert(tl("WideView")+b[a]||tl("Login control failure!"));return a},logoutWideView:function(){if(WideView.iconActived===0)$("ocx")&&$("ocx").LogoutWideView(),WideView.iconActived=!1,WideView.navChangeLeft()},varSetSupport:function(a){(WideView.support=a)?$("video_wideview").style.display="":$("video_wideview").style.display=
"none"},navChangeLeft:function(){if(WideView.isShow)WideView.isShow=!1,$("ocx").ShowWideView(!1),$("video_wideview").removeClass("ui-video-icon-current")},navChangeIn:function(){WideView.support&&WideView.requestGetConfig()},varSetIsShowIcon:function(a){(WideView.IsShowIcon=a)?$("video_wideview").removeClass("fn-hide"):$("video_wideview").addClass("fn-hide")},uichange:function(){WideView.isShow?$("video_wideview").removeClass("ui-video-icon-current"):$("video_wideview").addClass("ui-video-icon-current")},
ocxChange:function(){WideView.isShow?$("ocx")&&$("ocx").ShowWideView(!1):$("ocx")&&$("ocx").ShowWideView(!0)},requestGetConfig:function(){WideView.rpcConfig.getConfig("WideViewControl",function(a,b){b.result&&WideView.varSetIsShowIcon(b.params.table[0].Enable)})}},ManualEv={statusFlag:!1,rpcCall:null,init:function(){ManualEv.rpcCall=new RPCCall;$("b_manualEvidence").removeClass("fn-hide");$("b_manualEvidence").getPrevious().removeClass("fn-hide");ManualEv.bind()},bind:function(){$("b_manualEvidence").addEvent("click",
function(){ManualEv.statusFlag==!1&&onClearOCXFunction();ManualEv.varSetStatusFlag(!ManualEv.statusFlag)})},varSetStatusFlag:function(a){ManualEv.statusFlag=a;ManualEv.domStatusFlag(a);ManualEv.ocxStatusFlag(a)},domStatusFlag:function(a){a?$("b_manualEvidence").addClass("main-top-icon-mE-current"):$("b_manualEvidence").removeClass("main-top-icon-mE-current")},ocxStatusFlag:function(a){a?($("ocx").SetCurPtzID(0),$("ocx").AddShape(6,"","MannualEvidence",0,0)):$("ocx").DeleteShape("MannualEvidence")},
ocxBackStatusFlag:function(a){a=JSON.decode(a);a=[a.OutPutRuleRect[0][0],a.OutPutRuleRect[0][1],a.OutPutRuleRect[1][0],a.OutPutRuleRect[1][1]];a[0]+a[1]>a[2]+a[3]&&(a=[a[2],a[3],a[0],a[1]]);ManualEv.applySend(a)},applySend:function(a){var b={channel:0,object:[]};b.object.push({objectID:-1,boundingBox:a});a=ManualEv.rpcCall.getRequest("devVideoAnalyse.setAnalyseObject",JSON.encode(b));sendRequest(a,function(a){JSON.decode(a).result||alert("\u53d6\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u64cd\u4f5c")})}};
function openChangePwdDialog(a){var b=$("index_pwdDialog");b.setStyle("display","block");b.removeEvents();b.getElements(".ui-tip-red").set("text","");b.getElements("input[type=password]").setProperty("value","");b.getElement("input[name=newpwd]").focus();b.getElement("input[name=oldpwd]").value=a;b.getElements("input[type=checkbox]").setProperty("checked",!1);b.getElements(".ui-pwd-strength li").removeClass("current");b.addEvent('change:relay(input[name="noprompt"])',function(){Cookie.write("pwdNoTip",
this.checked?1:0,{duration:365})});b.addEvent('keyup:relay(input[type="password"])',function(){if(this.name=="newpwd"){var a=pwdStrenthValidator(this.value),d=b.getElement(".ui-pwd-strength");d&&(d.getElements("li").removeClass("current"),this.value&&d.getElements("li."+a).addClass("current"))}});return new Promise(function(a){b.addEvent('click:relay([data-for="ok"])',function(){var d=b.getElement("input[name=oldpwd]"),e=b.getElement("input[name=newpwd]"),f=b.getElement("input[name=newpwd2]"),d=d.value,
k=e.value,j=f.value;if(k=="admin")e.getNext().setProperty("text","Invalid Password");else if(k)if(k!==j)f.getNext().setProperty("text",tl("w_PwdDif"));else{var h="Login to ";(new MagicBox).getSerialNo(function(a,b){b.result?h+=b.params.sn:alert(tl("w_Badresult"))},!1);e=hex_md5(g_userInfo.Name+":"+h+":"+k);f=hex_md5(g_userInfo.Name+":"+h+":"+d);(new UserManager).modifyPassword(g_userInfo.Name,e,f,function(d,e){if(e.result){$("password").value=k;b.setStyle("display","none");a();var f=new Date,g=f.getFullYear(),
h=chk10(f.getMonth()+1),j=chk10(f.getDate()),n=chk10(f.getHours()),o=chk10(f.getMinutes()),f=chk10(f.getSeconds());(new Global).setCurrentTime(g+"-"+h+"-"+j+" "+(n+":"+o+":"+f),5,function(){})}else{g="w_ChangePwdFail";switch(e.error.code){case 604:g="w_useMannageErr_InputNotValid";break;case 605:g="w_useMannageErr_IndexOverlap_user";break;case 606:case 607:g="w_useMannageErr_ObjectNotValid_user";break;case 608:g="w_useMannageErr_ObjectInUse_user";break;case 609:g="w_useMannageErr_SubsetOverlap_user";
break;case 610:g="w_useMannageErr_SaveCfgError";break;case 611:g="w_useMannageErr_PwdNotValid";break;case 612:g="w_useMannageErr_PwdNotMatch";break;case 613:g="w_useMannageErr_ReservedAccount";break;case 614:g="w_useMannageErr_TooManyGroup";break;case 615:g="w_useMannageErr_TooManyUser"}alert(tl(g))}})}else e.getNext().setProperty("text",tl("w_passwordMustnotNull"))});b.addEvent('click:relay([data-for="cancel"])',function(){b.setStyle("display","none");a()})})}
function ImageSlider(a,b){var c=this,d=this.el=typeOf(a)==="element"?a:$(a),b=this.options=Object.merge(ImageSlider.options,b),e=this.fxs=[];this.imgs=d.getElements("li");this.currIndex=this.imgs.length-1;this.imgs.each(function(a,b){e[b]=new Fx.Tween(a,{property:"opacity",duration:c.options.duration})});this.startPlay()}
ImageSlider.prototype={startPlay:function(){var a=this,b=a.imgs.length,c=a.options;this.interval=setInterval(function(){var c=a.currIndex;a.currIndex=(a.currIndex+1)%b;a.switchPic(c,a.currIndex)},c.intervalTime+c.duration+c.nextStart)},switchPic:function(a,b){var c=this.fxs;c[a].removeEvents().start(1,0);setTimeout(function(){c[b].removeEvents().start(0,1)},this.nextStart)},stopPlay:function(){clearInterval(this.interval)}};ImageSlider.options={intervalTime:1E3,duration:1E3,nextStart:800};
