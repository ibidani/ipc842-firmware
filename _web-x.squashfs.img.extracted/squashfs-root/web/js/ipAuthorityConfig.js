(function(){var e,h,j,i,g,k,b=Page.ipAuthorityConfig={init:function(){b.configManager=new ConfigManager;b.dialogAddIP=new Dialog("ipAuthority_addIpDialog",b._onSaveAddIPClick,"ipAuthority_addConfirm","ipAuthority_addCancel",tl("w_Add IP/MAC"));b.dialogAddIP.setPosition(400,200);b.dialogModifyIP=new Dialog("ipAuthority_modifyIpDialog",b._onSaveModifyIPClick,"ipAuthority_modifyConfirm","ipAuthority_modifyCancel",tl("w_Modify IP/MAC"));b.dialogModifyIP.setPosition(400,200);b.dialogDeleteIP=new Dialog("ipAuthority_deleteDialog",
b._onSaveDeleteIPClick,"ipAuthority_deleteConfirm","ipAuthority_deleteCancel",tl("w_Delete IP/MAC"));b.dialogDeleteIP.setPosition(400,200);b.dialogRemoveAll=new Dialog("clearIPBox",b._onSaveRemoveAllClick,"ipAuthority_removeConfirm","ipAuthority_removeCancel",tl("w_Removeall IP/MAC"));b.dialogRemoveAll.setPosition(400,200);b.translate();b.render();b.bind()},translate:function(){$("ipAuthority_ipFilter").set("text",tl("w_IP Purview"));$$("#ipAuthority_trustedSitesLabel,#ipAuthority_trustedSitesTitle").set("text",
tl("w_WhiteList"));$("ipAuthority_ipAddressTitle").set("text",tl("w_IPaddr/MAC"));$("ipAuthority_modifyTitle").set("text",tl("w_Amend"));$("ipAuthority_deleteTitle").set("text",tl("Delete"));$("ipAuthority_addIpButton").set("text",tl("w_Add IP/MAC"));$("ipAuthority_default").set("text",tl("w_DefaultConfig"));$("ipAuthority_refresh").set("text",tl("w_Refresh"));$$("#ipAuthority_confirm,#ipAuthority_addConfirm,#ipAuthority_modifyConfirm,#ipAuthority_deleteConfirm,#ipAuthority_removeConfirm").set("text",
tl("w_Confirm"));$$("#ipAuthority_addIpAddressOption,#ipAuthority_modifyIpAddressOption").set("text",tl("IPaddr"));$$("#ipAuthority_addIpSegmentOption,#ipAuthority_modifyIpSegmentOption").set("text",tl("IP Area"));$$("#ipAuthority_addCancel,#ipAuthority_modifyCancel,#ipAuthority_deleteCancel,#ipAuthority_removeCancel").set("text",tl("Cancel"));$("ipAuthority_deleteIpSpan").set("text",tl("w_Sure to delete this IP or IP Area/MAC?"));$("ipAuthority_removeAllButton").set("text",tl("w_Removeall"));$("ipAuthority_help").set("title",
tl("w_help"));$$("#ipAuthority_addIpDialog h1").set("text",tl("w_Add IP/MAC"));$$("#ipAuthority_modifyIpDialog h1").set("text",tl("w_Modify IP/MAC"));$$("#ipAuthority_deleteDialog h1").set("text",tl("w_Delete IP/MAC"));$$("#clearIPBox h1").set("text",tl("w_Removeall IP/MAC"))},render:function(){b.configManager.getConfig(["AccessFilter","Network"],function(a){if(JSON.decode(a).result&&(e=JSON.decode(a).params[0].params.table,b._renderElements(),h=JSON.decode(a).params[1].params.table.eth0.IPAddress,
j=JSON.decode(a).params[1].params.table.eth0.PhysicalAddress,JSON.decode(a).params[1].params.table.eth2))i=JSON.decode(a).params[1].params.table.eth2.IPAddress},!1)},bind:function(){attachIpInput("ipAuthority_addInput0");attachIpInput("ipAuthority_addInput1");attachMACInput("ipAuthority_addInput2");attachIpInput("ipAuthority_modifyInput0");attachIpInput("ipAuthority_modifyInput1");attachMACInput("ipAuthority_modifyInput2");$("ipAuthority_addIpButton").addEvent("click",b._onAddIPClick);$$("#ipAuthority_addIpSelect,#ipAuthority_modifyIpSelect").addEvent("change",
b._onSelectIPChange);$("ipAuthority_removeAllButton").addEvent("click",b._onRemoveIPClick);$("ipAuthority_confirm").addEvent("click",b._onSaveClick);$("ipAuthority_refresh").addEvent("click",b._onRefreshClick);$("ipAuthority_default").addEvent("click",b._onDefaultClick);$("ipAuthority_help").addEvent("click",b._onHelpClick)},_onHelpClick:function(){openHelp("ipAuthorityConfig.htm")},_renderElements:function(){$("ipAuthority_trustedSites").checked=e.Enable;$("ipAuthority_showIpList").innerHTML="";
if(e.TrustList){for(var a=e.TrustList,c='<table cellpadding="0" cellspacing="0" >',d=0;d<a.length;d++)c+=d%2?'<tr id="ipAuthority_trustList_'+d+'" >':'<tr id="ipAuthority_trustList_'+d+'" class="ui-table-tr-odd">',c+='<td id="ipAuthority_trustListIP_'+d+'" class="fn-widp50">'+a[d]+"</td>",c+='<td class="fn-widp25"><i class="ui-table-icon-edit" id="ipAuthority_trustListModify_'+d+'" style="cursor:pointer;"></i></td>',c+='<td><i class="ui-table-icon-del" id="ipAuthority_trustListDelete_'+d+'"  style="cursor:pointer;"></i></td>',
c+="</tr>";c+="</table>";$("ipAuthority_showIpList").innerHTML=c;$$("#ipAuthority_showIpList tr").addEvent("click",function(){b._changeSelectedIdStyle(this.id)});$$("#ipAuthority_showIpList tr td [id^=ipAuthority_trustListModify_]").addEvent("click",function(){var a=this.id.replace(/[^\d]/g,"");b._onModifyIPClick(a)});$$("#ipAuthority_showIpList tr td [id^=ipAuthority_trustListDelete_]").addEvent("click",function(){var a=this.id.replace(/[^\d]/g,"");b._onDeleteIPClick(a)})}e.TrustList==null&&(e=JSON.decode('{"Enable" : false,"Type" : "BannedList","TrustList" : [],"BannedList" : []}'));
e.TrustList.length==0?($("ipAuthority_trustedSites").disabled=!0,$("ipAuthority_trustedSites").checked=!1):$("ipAuthority_trustedSites").disabled=!1},_onAddIPClick:function(){b._closeAllDialog();b.dialogAddIP.show();$("ipAuthority_addIpSelect").selectedIndex=0;$$("#ipAuthority_addInput1,#ipAuthority_addInput2").setStyle("display","none");$("ipAuthority_addInput0").style.display="";b._clearAllIP()},_closeAllDialog:function(){b.dialogAddIP.close();b.dialogModifyIP.close();b.dialogDeleteIP.close();b.dialogRemoveAll.close()},
_clearAllIP:function(){for(var a=0;a<4;a++)$("ipAuthority_addInput0"+a).value="",$("ipAuthority_addInput1"+a).value="",$("ipAuthority_modifyInput0"+a).value="",$("ipAuthority_modifyInput1"+a).value="";for(a=0;a<6;a++)$("ipAuthority_addInput2"+a).value="",$("ipAuthority_modifyInput2"+a).value=""},_onSelectIPChange:function(){switch($("ipAuthority_addIpSelect").selectedIndex){case 0:$("ipAuthority_addInput0").style.display="block";$$("#ipAuthority_addInput1,#ipAuthority_addInput2").setStyle("display",
"none");break;case 1:$$("#ipAuthority_addInput0,#ipAuthority_addInput1").setStyle("display","block");$("ipAuthority_addInput2").style.display="none";break;case 2:$$("#ipAuthority_addInput0,#ipAuthority_addInput1").setStyle("display","none"),$("ipAuthority_addInput2").style.display="block"}$$("#ipAuthority_addIpDialog .ui-autobox").setStyle("zoom",0).setStyle("zoom",1);switch($("ipAuthority_modifyIpSelect").selectedIndex){case 0:$("ipAuthority_modifyInput0").style.display="block";$$("#ipAuthority_modifyInput1,#ipAuthority_modifyInput2").setStyle("display",
"none");break;case 1:$$("#ipAuthority_modifyInput0,#ipAuthority_modifyInput1").setStyle("display","block");$("ipAuthority_modifyInput2").style.display="none";break;case 2:$$("#ipAuthority_modifyInput0,#ipAuthority_modifyInput1").setStyle("display","none"),$("ipAuthority_modifyInput2").style.display="block"}},_onRemoveIPClick:function(){b._closeAllDialog();$("ipAuthority_removeAllSpan").set("text",tl("w_Are you sure to clear IP/MAC?"));b.dialogRemoveAll.show()},_onSaveClick:function(){e.Enable=$("ipAuthority_trustedSites").checked;
e.Type="TrustList";b.configManager.setConfig("AccessFilter",e,function(a){JSON.decode(a).result?remarkDisplay("ipAuthority_remark",tl("Succeed in saving configure"),3E3,0):remarkDisplay("ipAuthority_remark",tl("Saving failure"),3E3,1)})},_onRefreshClick:function(){b.configManager.getConfig("AccessFilter",function(a){JSON.decode(a).result?(e=JSON.decode(a).params.table,b._renderElements(),remarkDisplay("ipAuthority_remark",tl("Operateingsuccess"),3E3,0)):remarkDisplay("ipAuthority_remark",tl("Operateingfailure"),
3E3,1)},!1)},_onDefaultClick:function(){b.configManager.getDefault("AccessFilter",function(a){JSON.decode(a).result?(e=JSON.decode(a).params.table,b._renderElements(),remarkDisplay("ipAuthority_remark",tl("Defaultsuccess"),3E3,0)):remarkDisplay("ipAuthority_remark",tl("Defaultfailure"),3E3,1)},!1)},_onSaveAddIPClick:function(){switch($("ipAuthority_addIpSelect").selectedIndex){case 2:if($("ipAuthority_addInput20").value==""||$("ipAuthority_addInput21").value==""||$("ipAuthority_addInput22").value==
""||$("ipAuthority_addInput23").value==""||$("ipAuthority_addInput24").value==""||$("ipAuthority_addInput25").value==""){remarkDisplay("ipAuthority_remark",tl("w_MAC Cannotbenull"),3E3,1);b.dialogAddIP.close();return}else{var a=$("ipAuthority_addInput20").value+":"+$("ipAuthority_addInput21").value+":"+$("ipAuthority_addInput22").value+":"+$("ipAuthority_addInput23").value+":"+$("ipAuthority_addInput24").value+":"+$("ipAuthority_addInput25").value;if(j.toLowerCase()==a.toLowerCase()){remarkDisplay("ipAuthority_remark",
tl("w_used"),3E3,1);b.dialogAddIP.close();return}else for(var c=0;c<e.TrustList.length;c++)if(a.toLowerCase()==e.TrustList[c].toLowerCase()){remarkDisplay("ipAuthority_remark",tl("w_MAC is exist"),3E3,1);b.dialogAddIP.close();return}}break;case 1:if($("ipAuthority_addInput00").value==""||$("ipAuthority_addInput01").value==""||$("ipAuthority_addInput02").value==""||$("ipAuthority_addInput03").value==""||$("ipAuthority_addInput10").value==""||$("ipAuthority_addInput11").value==""||$("ipAuthority_addInput12").value==
""||$("ipAuthority_addInput13").value==""){remarkDisplay("ipAuthority_remark",tl("IP Can not be null"),3E3,1);b.dialogAddIP.close();return}else if(a=$("ipAuthority_addInput00").value-0+"."+($("ipAuthority_addInput01").value-0)+"."+($("ipAuthority_addInput02").value-0)+"."+($("ipAuthority_addInput03").value-0)+"-"+($("ipAuthority_addInput10").value-0)+"."+($("ipAuthority_addInput11").value-0)+"."+($("ipAuthority_addInput12").value-0)+"."+($("ipAuthority_addInput13").value-0),c=i+"-"+i,h+"-"+h==a||
c==a){remarkDisplay("ipAuthority_remark",tl("w_deviceip"),3E3,1);b.dialogAddIP.close();return}else{c=($("ipAuthority_addInput00").value-0)*16777216+($("ipAuthority_addInput01").value-0)*65536+($("ipAuthority_addInput02").value-0)*256+($("ipAuthority_addInput03").value-0);($("ipAuthority_addInput10").value-0)*16777216+($("ipAuthority_addInput11").value-0)*65536+($("ipAuthority_addInput12").value-0)*256+($("ipAuthority_addInput13").value-0)-0<c-0&&(a=$("ipAuthority_addInput10").value-0+"."+($("ipAuthority_addInput11").value-
0)+"."+($("ipAuthority_addInput12").value-0)+"."+($("ipAuthority_addInput13").value-0)+"-"+($("ipAuthority_addInput00").value-0)+"."+($("ipAuthority_addInput01").value-0)+"."+($("ipAuthority_addInput02").value-0)+"."+($("ipAuthority_addInput03").value-0));for(c=0;c<e.TrustList.length;c++)if(a==e.TrustList[c]){remarkDisplay("ipAuthority_remark",tl("IP is exise"),3E3,1);b.dialogAddIP.close();return}}break;case 0:if($("ipAuthority_addInput00").value==""||$("ipAuthority_addInput01").value==""||$("ipAuthority_addInput02").value==
""||$("ipAuthority_addInput03").value==""){remarkDisplay("ipAuthority_remark",tl("IP Can not be null"),3E3,1);b.dialogAddIP.close();return}else if(a=$("ipAuthority_addInput00").value-0+"."+($("ipAuthority_addInput01").value-0)+"."+($("ipAuthority_addInput02").value-0)+"."+($("ipAuthority_addInput03").value-0),h==a||i==a){remarkDisplay("ipAuthority_remark",tl("w_deviceip"),3E3,1);b.dialogAddIP.close();return}else for(c=0;c<e.TrustList.length;c++)if(a==e.TrustList[c]){remarkDisplay("ipAuthority_remark",
tl("IP is exise"),3E3,1);b.dialogAddIP.close();return}}e.TrustList.include(a);b._renderElements();b._closeAllDialog();remarkDisplay("ipAuthority_remark",tl("w_Operateingsuccess"),3E3,0)},_onModifyIPClick:function(a){b._changeSelectedIdStyle("ipAuthority_trustListModify_"+a);g=e.TrustList[a];if(g.test(":")){$("ipAuthority_modifyIpSelect").selectedIndex=2;$("ipAuthority_modifyInput2").style.display="";$$("#ipAuthority_modifyInput0,#ipAuthority_modifyInput1").setStyle("display","none");for(var c=g.split(":"),
a=0;a<6;a++)$("ipAuthority_modifyInput2"+a).value=c[a]}else if(g.test("-")){$("ipAuthority_modifyIpSelect").selectedIndex=1;$$("#ipAuthority_modifyInput1,#ipAuthority_modifyInput0").setStyle("display","");$("ipAuthority_modifyInput2").style.display="none";for(var a=g.split("-"),c=a[0].split("."),d=a[1].split("."),a=0;a<4;a++)$("ipAuthority_modifyInput0"+a).value=c[a];for(a=0;a<4;a++)$("ipAuthority_modifyInput1"+a).value=d[a]}else{$("ipAuthority_modifyIpSelect").selectedIndex=0;$$("#ipAuthority_modifyInput1,#ipAuthority_modifyInput2").setStyle("display",
"none");$("ipAuthority_modifyInput0").style.display="";c=g.split(".");for(a=0;a<4;a++)$("ipAuthority_modifyInput0"+a).value=c[a]}b._closeAllDialog();b.dialogModifyIP.show()},_changeSelectedIdStyle:function(){for(var a=e.TrustList.length,b=0;b<a;b++){var d="ipAuthority_trustList_"+b;b%2?$(d).className="":$(d).className="ui-table-tr-odd"}},_onSaveModifyIPClick:function(){var a=e.TrustList,c=a.indexOf(g);switch($("ipAuthority_modifyIpSelect").selectedIndex){case 2:if($("ipAuthority_modifyInput20").value==
""||$("ipAuthority_modifyInput21").value==""||$("ipAuthority_modifyInput22").value==""||$("ipAuthority_modifyInput23").value==""||$("ipAuthority_modifyInput24").value==""||$("ipAuthority_modifyInput25").value==""){remarkDisplay("ipAuthority_remark",tl("w_MAC Cannotbenull"),3E3,1);b.dialogModifyIP.close();return}else{var d=$("ipAuthority_modifyInput20").value+":"+$("ipAuthority_modifyInput21").value+":"+$("ipAuthority_modifyInput22").value+":"+$("ipAuthority_modifyInput23").value+":"+$("ipAuthority_modifyInput24").value+
":"+$("ipAuthority_modifyInput25").value;if(j.toLowerCase()==d.toLowerCase()){remarkDisplay("ipAuthority_remark",tl("w_used"),3E3,1);b.dialogModifyIP.close();return}else if(d!=g)for(var f=0;f<e.TrustList.length;f++)if(d.toLowerCase()==e.TrustList[f].toLowerCase()){remarkDisplay("ipAuthority_remark",tl("w_MAC is exist"),3E3,1);b.dialogModifyIP.close();return}}a[c]=d;break;case 1:if($("ipAuthority_modifyInput00").value==""||$("ipAuthority_modifyInput01").value==""||$("ipAuthority_modifyInput02").value==
""||$("ipAuthority_modifyInput03").value==""||$("ipAuthority_modifyInput10").value==""||$("ipAuthority_modifyInput11").value==""||$("ipAuthority_modifyInput12").value==""||$("ipAuthority_modifyInput13").value==""){remarkDisplay("ipAuthority_remark",tl("IP Can not be null"),3E3,1);b.dialogModifyIP.close();return}else if(d=$("ipAuthority_modifyInput00").value-0+"."+($("ipAuthority_modifyInput01").value-0)+"."+($("ipAuthority_modifyInput02").value-0)+"."+($("ipAuthority_modifyInput03").value-0)+"-"+
($("ipAuthority_modifyInput10").value-0)+"."+($("ipAuthority_modifyInput11").value-0)+"."+($("ipAuthority_modifyInput12").value-0)+"."+($("ipAuthority_modifyInput13").value-0),f=i+"-"+i,h+"-"+h==d||f==d){remarkDisplay("ipAuthority_remark",tl("w_deviceip"),3E3,1);b.dialogModifyIP.close();return}else if(f=($("ipAuthority_modifyInput00").value-0)*16777216+($("ipAuthority_modifyInput01").value-0)*65536+($("ipAuthority_modifyInput02").value-0)*256+($("ipAuthority_modifyInput03").value-0),($("ipAuthority_modifyInput10").value-
0)*16777216+($("ipAuthority_modifyInput11").value-0)*65536+($("ipAuthority_modifyInput12").value-0)*256+($("ipAuthority_modifyInput13").value-0)-0<f-0&&(d=$("ipAuthority_modifyInput10").value-0+"."+($("ipAuthority_modifyInput11").value-0)+"."+($("ipAuthority_modifyInput12").value-0)+"."+($("ipAuthority_modifyInput13").value-0)+"-"+($("ipAuthority_modifyInput00").value-0)+"."+($("ipAuthority_modifyInput01").value-0)+"."+($("ipAuthority_modifyInput02").value-0)+"."+($("ipAuthority_modifyInput03").value-
0)),d!=g)for(f=0;f<e.TrustList.length;f++)if(d==e.TrustList[f]){remarkDisplay("ipAuthority_remark",tl("IP is exise"),3E3,1);b.dialogModifyIP.close();return}a[c]=d;break;case 0:if($("ipAuthority_modifyInput00").value==""||$("ipAuthority_modifyInput01").value==""||$("ipAuthority_modifyInput02").value==""||$("ipAuthority_modifyInput03").value==""){remarkDisplay("ipAuthority_remark",tl("IP Can not be null"),3E3,1);b.dialogModifyIP.close();return}else if(d=$("ipAuthority_modifyInput00").value-0+"."+($("ipAuthority_modifyInput01").value-
0)+"."+($("ipAuthority_modifyInput02").value-0)+"."+($("ipAuthority_modifyInput03").value-0),h==d||i==d){remarkDisplay("ipAuthority_remark",tl("w_deviceip"),3E3,1);b.dialogModifyIP.close();return}else if(d!=g)for(f=0;f<e.TrustList.length;f++)if(d==e.TrustList[f]){remarkDisplay("ipAuthority_remark",tl("IP is exise"),3E3,1);b.dialogModifyIP.close();return}a[c]=d}b._renderElements();b._closeAllDialog();b._clearAllIP();remarkDisplay("ipAuthority_remark",tl("w_Operateingsuccess"),3E3,0)},_onSaveRemoveAllClick:function(){e.TrustList=
[];b._renderElements();b._closeAllDialog();remarkDisplay("ipAuthority_remark",tl("w_Operateingsuccess"),3E3,0)},_onDeleteIPClick:function(a){b._changeSelectedIdStyle("ipAuthority_trustListDelete_"+a);k=e.TrustList[a];b._closeAllDialog();b.dialogDeleteIP.show()},_onSaveDeleteIPClick:function(){e.TrustList.erase(k);b._renderElements();b._closeAllDialog();remarkDisplay("ipAuthority_remark",tl("w_Operateingsuccess"),3E3,0)}}})();
